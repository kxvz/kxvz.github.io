{"name":"kafka","slug":"kafka","count":1,"postlist":[{"title":"Centos安装Kafka","slug":"Centos安装Kafka","date":"2018-12-11T09:52:51.000Z","updated":"2018-12-11T09:52:51.182Z","comments":true,"path":"api/articles/Centos安装Kafka.json","excerpt":"","keywords":null,"cover":null,"content":"<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">### 首先需要安装好 Scala 2.12</span></span><br><span class=\"line\"><span class=\"comment\">### 下载页面: http://kafka.apache.org/downloads</span></span><br><span class=\"line\"><span class=\"comment\">### 下载地址:https://www.apache.org/dyn/closer.cgi?path=/kafka/0.10.2.0/kafka_2.12-0.10.2.0.tgz</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">###　解压出来</span></span><br><span class=\"line\">tar -zxvf kafka_2.12-0.10.2.0.tgz</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">cd</span> kafka_2.12-0.10.2.0</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 启动 (启动之前需要先启动好Zookeeper 并在 server.properties 配置好zookeeper的连接)</span></span><br><span class=\"line\">bin/kafka-server-start.sh -daemon config/server.properties</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 停止</span></span><br><span class=\"line\">bin/kafka-server-stop.sh</span><br></pre></td></tr></table></figure></div>\n<p>配置文件 server.properties 说明:<br><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 当前机器在集群中的唯一标识，和zookeeper的myid性质一样</span></span><br><span class=\"line\">broker.id=0</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Switch to enable topic deletion or not, default value is false</span></span><br><span class=\"line\"><span class=\"comment\">#delete.topic.enable=true</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 消息保存的最大值5M</span></span><br><span class=\"line\">message.max.byte=5242880</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># kafka保存消息的副本数，如果一个副本失效了，另一个还可以继续提供服务</span></span><br><span class=\"line\">default.replication.factor=2</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 取消息的最大直接数</span></span><br><span class=\"line\">replica.fetch.max.bytes=5242880</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">############################# Socket Server Settings #############################</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 当前kafka对外提供服务的端口默认是9092</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">port</span>=<span class=\"number\">18082</span></span><br><span class=\"line\"></span><br><span class=\"line\">host.name=192.168.99.250</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Hostname and port the broker will advertise to producers and consumers. If not set, </span></span><br><span class=\"line\"><span class=\"comment\"># it uses the value for \"listeners\" if configured.  Otherwise, it will use the value</span></span><br><span class=\"line\"><span class=\"comment\"># returned from java.net.InetAddress.getCanonicalHostName().</span></span><br><span class=\"line\"><span class=\"comment\">#advertised.listeners=PLAINTEXT://your.host.name:9092</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Maps listener names to security protocols, the default is for them to be the same. See the config documentation for more details</span></span><br><span class=\"line\"><span class=\"comment\">#listener.security.protocol.map=PLAINTEXT:PLAINTEXT,SSL:SSL,SASL_PLAINTEXT:SASL_PLAINTEXT,SASL_SSL:SASL_SSL</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 这个是borker进行网络处理的线程数</span></span><br><span class=\"line\">num.network.threads=3</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 这个是borker进行I/O处理的线程数</span></span><br><span class=\"line\">num.io.threads=8</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 发送缓冲区buffer大小，数据不是一下子就发送的，先回存储到缓冲区了到达一定的大小后在发送，能提高性能</span></span><br><span class=\"line\">socket.send.buffer.bytes=102400</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># kafka接收缓冲区大小，当数据到达一定大小后在序列化到磁盘</span></span><br><span class=\"line\">socket.receive.buffer.bytes=102400</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 这个参数是向kafka请求消息或者向kafka发送消息的请请求的最大数，这个值不能超过java的堆栈大小</span></span><br><span class=\"line\">socket.request.max.bytes=104857600</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">############################# Log Basics #############################</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 消息存放的目录，这个目录可以配置为“，”逗号分割的表达式，上面的num.io.threads要大于这个目录的个数这个目录，如果配置多个目录，新创建的topic他把消息持久化的地方是，当前以逗号分割的目录中，那个分区数最少就放那一个</span></span><br><span class=\"line\">log.dirs=/tmp/kafka-logs</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 默认的分区数，一个topic默认1个分区数</span></span><br><span class=\"line\">num.partitions=1</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 每个数据目录用来日志恢复的线程数</span></span><br><span class=\"line\">num.recovery.threads.per.data.dir=1</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">############################# Log Flush Policy #############################</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 是否启用log压缩，一般不用启用，启用的话可以提高性能</span></span><br><span class=\"line\">log.cleaner.enable=false </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 当消息数量到达10000时强制写入到磁盘 (一般不建议使用这个选项)</span></span><br><span class=\"line\"><span class=\"comment\">#log.flush.interval.messages=10000</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 强制写入磁盘的间隔时间 (一般不建议使用这个选项)</span></span><br><span class=\"line\"><span class=\"comment\">#log.flush.interval.ms=1000</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">############################# Log Retention Policy #############################</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 默认消息的最大持久化时间，168小时，7天</span></span><br><span class=\"line\">log.retention.hours=168</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 这个参数是：因为kafka的消息是以追加的形式落地到文件，当超过这个值的时候，kafka会新起一个文件</span></span><br><span class=\"line\">log.segment.bytes=1073741824</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 每隔300000毫秒去检查上面配置的log失效时间（log.retention.hours=168 ），到目录查看是否有过期的消息如果有，删除</span></span><br><span class=\"line\">log.retention.check.interval.ms=300000</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">############################# Zookeeper #############################</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># zookeeper的连接配置</span></span><br><span class=\"line\">zookeeper.connect=192.168.101.251:2181,192.168.10.252:2181,192.168.10.253:2181,192.168.10.254:2181</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 访问zookeeper的超时时间</span></span><br><span class=\"line\">zookeeper.connection.timeout.ms=6000</span><br></pre></td></tr></table></figure></p>\n","text":"1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>### 首先需要安装好 Scala 2.12<br>### 下载页面: http://kafka.apache.org/downl","link":"","raw":null,"photos":[],"categories":[{"name":"Centos","slug":"Centos","count":30,"path":"api/categories/Centos.json"},{"name":"kafka","slug":"Centos/kafka","count":1,"path":"api/categories/Centos/kafka.json"}],"tags":[{"name":"Centos","slug":"Centos","count":29,"path":"api/tags/Centos.json"},{"name":"kafka","slug":"kafka","count":1,"path":"api/tags/kafka.json"}]}]}