{"name":"angularjs","slug":"js/angularjs","count":1,"postlist":[{"title":"AngularJS 的安全Apply","slug":"AngularJS-的安全Apply","date":"2018-12-11T10:10:09.000Z","updated":"2018-12-11T10:10:09.292Z","comments":true,"path":"api/articles/AngularJS-的安全Apply.json","excerpt":"","keywords":null,"cover":null,"content":"<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"JS\"><figure class=\"iseeu highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$scope.safeApply = <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">fn</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">var</span> phase = <span class=\"keyword\">this</span>.$root.$$phase;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (phase == <span class=\"string\">'$apply'</span> || phase == <span class=\"string\">'$digest'</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (fn &amp;&amp; (<span class=\"keyword\">typeof</span>(fn) === <span class=\"string\">'function'</span>)) &#123;</span><br><span class=\"line\">            fn();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.$apply(fn);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure></div>\n<p>使用NG的时候会遇到动态添加数据的情况,有可能在你动态添加数据后页面因为渲染已经完成了导致新添加的数据在页面中无法展示</p>\n<p>如使用select标签:<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"JS\"><figure class=\"iseeu highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;select id=<span class=\"string\">\"uidSelect\"</span> <span class=\"class\"><span class=\"keyword\">class</span></span>=<span class=\"string\">\"sel\"</span> ng-model=<span class=\"string\">\"sid\"</span> ng-init=<span class=\"string\">\"\"</span> ng-options=<span class=\"string\">\"user.name for user in users\"</span>&gt;</span><br><span class=\"line\">  &lt;option value=<span class=\"string\">\"\"</span> <span class=\"keyword\">default</span>&gt;-Select one-&lt;/option&gt;</span><br><span class=\"line\">&lt;<span class=\"regexp\">/select&gt;</span></span><br></pre></td></tr></table></figure></div></p>\n<p>因为开始的时候users数组的数据是固定的浏览器渲染出来后值就是固定的,那么如果在这之后我们想往users里面添加数据这个下拉选项是不会有改变的,这时候度娘上的各种攻略会告诉你加上 $scope.$apply() 就可以了…但是加好以后有可能会出现 [$rootScope:inprog] $apply already in progress 这样的错误信息,那么这时候只需要使用最上面提供的方法就可以了,</p>\n<p>先把最上面的 safeApply 方法加入你的 scope 里面,然后动态添加完数据后 使用 $scope.safeApply(); 就可以了….</p>\n","text":"1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>$scope.safeApply = function(fn) &#123;<br>    var phase = this.$root.$$phase;<br>    if (","link":"","raw":null,"photos":[],"categories":[{"name":"js","slug":"js","count":2,"path":"api/categories/js.json"},{"name":"angularjs","slug":"js/angularjs","count":1,"path":"api/categories/js/angularjs.json"}],"tags":[{"name":"js","slug":"js","count":2,"path":"api/tags/js.json"},{"name":"angularjs","slug":"angularjs","count":1,"path":"api/tags/angularjs.json"},{"name":"apply","slug":"apply","count":1,"path":"api/tags/apply.json"}]}]}