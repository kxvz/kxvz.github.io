{"name":"mysql","slug":"Centos/mysql","count":2,"postlist":[{"title":"Centos安装Java和Mysql","slug":"Centos安装Java和Mysql","date":"2018-12-11T10:14:40.000Z","updated":"2018-12-11T10:15:08.696Z","comments":true,"path":"api/articles/Centos安装Java和Mysql.json","excerpt":"","keywords":null,"cover":null,"content":"<p>首先,下载JDK: <a href=\"jdk-8u45-linux-x64.rpm\">jdk-8u45-linux-x64.rpm</a></p>\n<p>运行安装命令:<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum localinstall -y jdk-8u45-linux-x64.rpm</span><br></pre></td></tr></table></figure></div></p>\n<p>安装Mysql:</p>\n<p>下载Mysql: <a href=\"http://repo.mysql.com/\" target=\"_blank\" rel=\"noopener\">mysql-community-release-el6-5.noarch.rpm</a></p>\n<p>运行安装命令:<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum localinstall mysql-community-release-el6-5.noarch.rpm</span><br></pre></td></tr></table></figure></div></p>\n<p>更新好了Mysql的安装源后直接执行:<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo yum install -y mysql-community-server</span><br></pre></td></tr></table></figure></div></p>\n<p>启动Mysql:<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">service mysqld start</span><br></pre></td></tr></table></figure></div></p>\n<p>第一次启动需要设置root密码:<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysqladmin -u root password <span class=\"string\">'yourpassword'</span></span><br></pre></td></tr></table></figure></div></p>\n<p>5.7版本设置密码:<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">### 5.7 安装好后会默认生成一个密码, 需要启动Mysqld服务后可以查看</span></span><br><span class=\"line\"></span><br><span class=\"line\">grep <span class=\"string\">'temporary password'</span> /var/<span class=\"built_in\">log</span>/mysqld.log</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 查看的结果: eHI9*)Tl/zP?</span></span><br><span class=\"line\">A temporary password is generated <span class=\"keyword\">for</span> root@localhost: eHI9*)Tl/zP?</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 修改弱密码验证 避免无法更改为弱密码</span></span><br><span class=\"line\"><span class=\"built_in\">set</span> global validate_password_policy = 0;</span><br><span class=\"line\"><span class=\"built_in\">set</span> global validate_password_length = 4;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 设置新密码</span></span><br><span class=\"line\">SET PASSWORD = PASSWORD(<span class=\"string\">'123456'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 刷新</span></span><br><span class=\"line\">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure></div></p>\n<p>登陆Mysql:<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql -u root -p[yourpassword]  <span class=\"comment\">### 实际使用中,不需要写[],此处为了区分参数 -p 和 密码</span></span><br></pre></td></tr></table></figure></div></p>\n<p>检查Mysql是否开机启动:<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chkconfig --list | grep mysqld   <span class=\"comment\">### 刚安装的都是 off  没有开机启动的</span></span><br></pre></td></tr></table></figure></div></p>\n<p>设置mysql 的开机启动<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chkconfig mysqld on</span><br></pre></td></tr></table></figure></div></p>\n<p>外网访问:<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">use mysql;</span><br><span class=\"line\"></span><br><span class=\"line\">update user <span class=\"built_in\">set</span> host = <span class=\"string\">'%'</span> <span class=\"built_in\">where</span> user =<span class=\"string\">'root'</span> and password is not null and password != <span class=\"string\">''</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">flush privileges;</span><br></pre></td></tr></table></figure></div></p>\n<p>Mysql8出现”cache_sha2_passward”的处理<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">### 更改密码规则 并设置密码为 123456</span></span><br><span class=\"line\"> </span><br><span class=\"line\">ALTER USER <span class=\"string\">'root'</span>@<span class=\"string\">'localhost'</span> IDENTIFIED BY <span class=\"string\">'123456'</span> PASSWORD EXPIRE NEVER;</span><br><span class=\"line\">ALTER USER <span class=\"string\">'root'</span>@<span class=\"string\">'localhost'</span> IDENTIFIED WITH mysql_native_password BY <span class=\"string\">'123456'</span>;</span><br><span class=\"line\">FLUSH PRIVILEGES;</span><br><span class=\"line\"> </span><br><span class=\"line\">alter user <span class=\"string\">'root'</span>@<span class=\"string\">'localhost'</span> identified by <span class=\"string\">'123456'</span>;</span><br></pre></td></tr></table></figure></div></p>\n","text":"首先,下载JDK: jdk-8u45-linux-x64.rpm运行安装命令:<br>1<br>sudo yum localinstall -y jdk-8u45-linux-x64.rpm<br>安装Mysql:下载Mysql: mysql-community-release-","link":"","raw":null,"photos":[],"categories":[{"name":"Centos","slug":"Centos","count":30,"path":"api/categories/Centos.json"},{"name":"mysql","slug":"Centos/mysql","count":2,"path":"api/categories/Centos/mysql.json"},{"name":"java","slug":"Centos/mysql/java","count":1,"path":"api/categories/Centos/mysql/java.json"}],"tags":[{"name":"Centos","slug":"Centos","count":29,"path":"api/tags/Centos.json"},{"name":"install","slug":"install","count":9,"path":"api/tags/install.json"},{"name":"java","slug":"java","count":25,"path":"api/tags/java.json"},{"name":"mysql","slug":"mysql","count":10,"path":"api/tags/mysql.json"}]},{"title":"Centos转移Mysql的数据位置","slug":"Centos转移Mysql的数据位置","date":"2018-12-11T10:17:11.000Z","updated":"2018-12-11T10:17:11.470Z","comments":true,"path":"api/articles/Centos转移Mysql的数据位置.json","excerpt":"","keywords":null,"cover":null,"content":"<p>首先，假设我们需要把Mysql的数据存储位置转到到  /data 下面</p>\n<p>第一步：<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">service mysqld stop</span><br></pre></td></tr></table></figure></div></p>\n<p>第二步：<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">### 备份原来的 mysql</span></span><br><span class=\"line\"></span><br><span class=\"line\">cp -a /var/lib/mysql /var/lib/mysql_bak</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 转移 mysql</span></span><br><span class=\"line\">cp -a /var/lib/mysql /data/</span><br></pre></td></tr></table></figure></div></p>\n<p>转移完成后我们需要修改一些参数让mysql能使用新的地址：<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">### 备份原来的文件配置信息</span></span><br><span class=\"line\">cp -a /etc/my.cnf /etc/my.cnf_bak</span><br><span class=\"line\"><span class=\"comment\">### 修改原来的配置文件</span></span><br><span class=\"line\">vi /etc/my.cnf</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 找到 datadir 并把值修改为 ：  datadir=/data/mysql</span></span><br><span class=\"line\"><span class=\"comment\">### 找到 socket 并把值修改为 ：   socket=/data/mysql/mysql.sock</span></span><br></pre></td></tr></table></figure></div></p>\n<p>修改第二个配置文件：<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">### 备份原来的文件信息</span></span><br><span class=\"line\">cp -a /etc/init.d/mysqld /etc/init.d/mysqld_bak</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 修改原来的文件信息</span></span><br><span class=\"line\">vi /etc/init.d/mysqld</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 找到 get_mysql_option mysqld datadir </span></span><br><span class=\"line\"><span class=\"comment\">### 并把值修改为 ： get_mysql_option mysqld datadir \"/data/mysql\"</span></span><br><span class=\"line\"><span class=\"comment\">### 找到 datadir 并把值修改为 ： datadir=\"/data/mysql\"</span></span><br></pre></td></tr></table></figure></div></p>\n<p>配置文件修改完成后建立mysql sock 的软连接<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">### 进入原来的mysql目录</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> /ver/lib/mysql</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 移除里面的内容</span></span><br><span class=\"line\">rm -rf *</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 建立 mysql.sock 的软连接</span></span><br><span class=\"line\">ln -s /data/mysql/mysql.sock /var/lib/mysql/mysql.sock</span><br></pre></td></tr></table></figure></div></p>\n<p>启动 mysql<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">service mysqld start</span><br></pre></td></tr></table></figure></div></p>\n<p>如果出现权限类的问题：<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">### 修改权限错误的文件或文件夹 如修改：/data/mysql 的文件夹权限命令</span></span><br><span class=\"line\">chcon -R -t mysqld_db_t /data/mysql</span><br></pre></td></tr></table></figure></div></p>\n<p>如果修改了相应的文件夹权限还是无法启动</p>\n<p>修改系统的权限验证：<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /etc/selinux/config</span><br><span class=\"line\"><span class=\"comment\">### 找到 SELINUX 并把值修改为： SELINUX=disabled</span></span><br><span class=\"line\">Esc  :wq</span><br><span class=\"line\"><span class=\"comment\">### 修改完成保存后重启系统</span></span><br><span class=\"line\">reboot</span><br></pre></td></tr></table></figure></div></p>\n<p>==注意：以上操作如果是在生产环境中请谨慎操作。。==</p>\n","text":"首先，假设我们需要把Mysql的数据存储位置转到到  /data 下面第一步：<br>1<br>service mysqld stop<br>第二步：<br>1<br>2<br>3<br>4<br>5<br>6<br>### 备份原来的 mysql<br><br>cp -a /v","link":"","raw":null,"photos":[],"categories":[{"name":"Centos","slug":"Centos","count":30,"path":"api/categories/Centos.json"},{"name":"mysql","slug":"Centos/mysql","count":2,"path":"api/categories/Centos/mysql.json"}],"tags":[{"name":"Centos","slug":"Centos","count":29,"path":"api/tags/Centos.json"},{"name":"mysql","slug":"mysql","count":10,"path":"api/tags/mysql.json"}]}]}