{"total":94,"pageSize":10,"pageCount":10,"data":[{"title":"关于Java去连接HTTP地址的操作","slug":"关于Java去连接HTTP地址的操作","date":"2018-12-11T10:36:15.000Z","updated":"2018-12-11T10:36:15.250Z","comments":true,"path":"api/articles/关于Java去连接HTTP地址的操作.json","excerpt":"","keywords":null,"cover":null,"content":"<p>使用HTTPClient进行操作,可以忽略SSL</p>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"JAVA\"><figure class=\"iseeu highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> Kai</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Date</span> 2015-7-28 19:47:16</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">HTTPClient</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//HTTP请求读取超时时间</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> SOCKET_TIME_OUT = <span class=\"number\">5000</span>;</span><br><span class=\"line\">    <span class=\"comment\">//HTTP请求连接时间</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> CONNECT_TIME_OUT = <span class=\"number\">5000</span>;</span><br><span class=\"line\">    <span class=\"comment\">//请求重试次数</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> RETRY_TIMES = <span class=\"number\">3</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">     <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> address 请求地址</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> method  请求方式</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> params 请求参数</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> paramSendType 发送类型</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> cookies 设置cookies值发送</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">request</span><span class=\"params\">(String address, String method, String params, String paramSendType, String cookies)</span> </span>&#123;</span><br><span class=\"line\">        address = address.trim();</span><br><span class=\"line\">        CloseableHttpResponse closeableHttpResponse = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (SupportProtocol.HTTP_METHOD_GET.equalsIgnoreCase(method)) &#123;</span><br><span class=\"line\">            closeableHttpResponse = <span class=\"keyword\">this</span>.GET(address, params, paramSendType, cookies);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (SupportProtocol.HTTP_METHOD_POST.equalsIgnoreCase(method)) &#123;</span><br><span class=\"line\">            closeableHttpResponse = <span class=\"keyword\">this</span>.POST(address, params, paramSendType, cookies);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (SupportProtocol.HTTP_METHOD_PUT.equalsIgnoreCase(method)) &#123;</span><br><span class=\"line\">            closeableHttpResponse = <span class=\"keyword\">this</span>.PUT(address, params, paramSendType, cookies);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            closeableHttpResponse = <span class=\"keyword\">this</span>.POST(address, params, paramSendType, cookies);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.buildReponseMsg(closeableHttpResponse);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> CloseableHttpResponse <span class=\"title\">PUT</span><span class=\"params\">(String address, String params, String paramSendType, String cookies)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            URI uri = URI.create(address);</span><br><span class=\"line\">            HttpPut httpPut = <span class=\"keyword\">new</span> HttpPut(uri);</span><br><span class=\"line\">            RequestConfig requestConfig = RequestConfig.custom().setSocketTimeout(SOCKET_TIME_OUT).setConnectTimeout(CONNECT_TIME_OUT).build();</span><br><span class=\"line\">            httpPut.setConfig(requestConfig);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (SupportProtocol.SUPPORT_JSON.equalsIgnoreCase(paramSendType)) &#123;</span><br><span class=\"line\">                httpPut.setHeader(<span class=\"string\">\"Content-Type\"</span>, <span class=\"string\">\"application/json; charset=UTF-8\"</span>);</span><br><span class=\"line\">                StringEntity entity = <span class=\"keyword\">new</span> StringEntity(params, ContentType.APPLICATION_JSON);</span><br><span class=\"line\">                httpPut.setEntity(entity);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (SupportProtocol.SUPPORT_JSON.equalsIgnoreCase(paramSendType)) &#123;</span><br><span class=\"line\">                httpPut.setHeader(<span class=\"string\">\"Content-Type\"</span>, <span class=\"string\">\"application/xml; charset=UTF-8\"</span>);</span><br><span class=\"line\">                StringEntity entity = <span class=\"keyword\">new</span> StringEntity(params, ContentType.APPLICATION_XML);</span><br><span class=\"line\">                httpPut.setEntity(entity);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                httpPut.setHeader(<span class=\"string\">\"Content-Type\"</span>, <span class=\"string\">\"application/x-www-form-urlencoded; charset=UTF-8\"</span>);</span><br><span class=\"line\">                StringEntity entity = <span class=\"keyword\">new</span> StringEntity(params, ContentType.APPLICATION_FORM_URLENCODED);</span><br><span class=\"line\">                httpPut.setEntity(entity);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (StrUtil.isNotEmpty(cookies)) &#123;</span><br><span class=\"line\">                httpPut.setHeader(<span class=\"string\">\"Cookie\"</span>, cookies);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            CloseableHttpClient httpClient = HttpClients.createDefault();</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (address.toLowerCase().startsWith(<span class=\"string\">\"https\"</span>)) &#123;</span><br><span class=\"line\">                httpClient = <span class=\"keyword\">this</span>.createSSLClientDefault();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">return</span> httpClient.execute(httpPut);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception ex) &#123;</span><br><span class=\"line\">            LogUtil.error(ex);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> CloseableHttpResponse <span class=\"title\">GET</span><span class=\"params\">(String address, String params, String paramSendType, String cookies)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            URI uri;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (EmptyUtil.isNotEmpty(params)) &#123;</span><br><span class=\"line\">                uri = URI.create(String.format(<span class=\"string\">\"%s?%s\"</span>, address, params));</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                uri = URI.create(address);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            HttpGet httpGet = <span class=\"keyword\">new</span> HttpGet(uri);</span><br><span class=\"line\">            RequestConfig requestConfig = RequestConfig.custom().setSocketTimeout(SOCKET_TIME_OUT).setConnectTimeout(CONNECT_TIME_OUT).build();</span><br><span class=\"line\">            httpGet.setConfig(requestConfig);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (SupportProtocol.SUPPORT_JSON.equalsIgnoreCase(paramSendType)) &#123;</span><br><span class=\"line\">                httpGet.setHeader(<span class=\"string\">\"Content-Type\"</span>, <span class=\"string\">\"application/json; charset=UTF-8\"</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (SupportProtocol.SUPPORT_XML.equalsIgnoreCase(paramSendType)) &#123;</span><br><span class=\"line\">                httpGet.setHeader(<span class=\"string\">\"Content-Type\"</span>, <span class=\"string\">\"application/xml; charset=UTF-8\"</span>);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                httpGet.setHeader(<span class=\"string\">\"Content-Type\"</span>, <span class=\"string\">\"application/x-www-form-urlencoded; charset=UTF-8\"</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (StrUtil.isNotEmpty(cookies)) &#123;</span><br><span class=\"line\">                httpGet.setHeader(<span class=\"string\">\"Cookie\"</span>, cookies);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            CloseableHttpClient httpClient = HttpClients.createDefault();</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (address.toLowerCase().startsWith(<span class=\"string\">\"https\"</span>)) &#123;</span><br><span class=\"line\">                httpClient = <span class=\"keyword\">this</span>.createSSLClientDefault();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> httpClient.execute(httpGet);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception ex) &#123;</span><br><span class=\"line\">            LogUtil.error(ex);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> CloseableHttpResponse <span class=\"title\">POST</span><span class=\"params\">(String address, String params, String paramSendType, String cookies)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            URI uri = URI.create(address);</span><br><span class=\"line\">            HttpPost httpPost = <span class=\"keyword\">new</span> HttpPost(uri);</span><br><span class=\"line\">            RequestConfig requestConfig = RequestConfig.custom().setSocketTimeout(SOCKET_TIME_OUT).setConnectTimeout(CONNECT_TIME_OUT).build();</span><br><span class=\"line\">            httpPost.setConfig(requestConfig);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (SupportProtocol.SUPPORT_JSON.equalsIgnoreCase(paramSendType)) &#123;</span><br><span class=\"line\">                httpPost.setHeader(<span class=\"string\">\"Content-Type\"</span>, <span class=\"string\">\"application/json; charset=UTF-8\"</span>);</span><br><span class=\"line\">                StringEntity entity = <span class=\"keyword\">new</span> StringEntity(params, ContentType.APPLICATION_JSON);</span><br><span class=\"line\">                httpPost.setEntity(entity);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (SupportProtocol.SUPPORT_XML.equalsIgnoreCase(paramSendType)) &#123;</span><br><span class=\"line\">                httpPost.setHeader(<span class=\"string\">\"Content-Type\"</span>, <span class=\"string\">\"application/xml; charset=UTF-8\"</span>);</span><br><span class=\"line\">                StringEntity entity = <span class=\"keyword\">new</span> StringEntity(params, ContentType.APPLICATION_XML);</span><br><span class=\"line\">                httpPost.setEntity(entity);</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                httpPost.setHeader(<span class=\"string\">\"Content-Type\"</span>, <span class=\"string\">\"application/x-www-form-urlencoded; charset=UTF-8\"</span>);</span><br><span class=\"line\">                StringEntity entity = <span class=\"keyword\">new</span> StringEntity(params, ContentType.APPLICATION_FORM_URLENCODED);</span><br><span class=\"line\">                httpPost.setEntity(entity);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (StrUtil.isNotEmpty(cookies)) &#123;</span><br><span class=\"line\">                httpPost.setHeader(<span class=\"string\">\"Cookie\"</span>, cookies);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            CloseableHttpClient httpClient = HttpClients.createDefault();</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (address.toLowerCase().startsWith(<span class=\"string\">\"https\"</span>)) &#123;</span><br><span class=\"line\">                httpClient = <span class=\"keyword\">this</span>.createSSLClientDefault();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> httpClient.execute(httpPost);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception ex) &#123;</span><br><span class=\"line\">            LogUtil.error(ex);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> CloseableHttpClient <span class=\"title\">createSSLClientDefault</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            SSLContext sslContext = <span class=\"keyword\">new</span> SSLContextBuilder().loadTrustMaterial(<span class=\"keyword\">null</span>, <span class=\"keyword\">new</span> TrustStrategy() &#123;</span><br><span class=\"line\">                <span class=\"meta\">@Override</span></span><br><span class=\"line\">                <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isTrusted</span><span class=\"params\">(X509Certificate[] chain,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                        String authType)</span> <span class=\"keyword\">throws</span> CertificateException </span>&#123;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;).build();</span><br><span class=\"line\">            SSLSocketFactory ssf = <span class=\"keyword\">new</span> SSLSocketFactory(sslContext, SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> HttpClients.custom().setSSLSocketFactory(ssf).build();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            LogUtil.error(e.getMessage());</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> HttpClients.createDefault();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> String <span class=\"title\">buildReponseMsg</span><span class=\"params\">(CloseableHttpResponse closeableHttpResponse)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (closeableHttpResponse == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> code = closeableHttpResponse.getStatusLine().getStatusCode();</span><br><span class=\"line\">            String msg = EntityUtils.toString(closeableHttpResponse.getEntity());</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (code == HttpStatus.SC_OK) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> msg;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception ex) &#123;</span><br><span class=\"line\">            LogUtil.error(ex);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div>\n<p>使用URLConnection读取数据,访问HTTPS貌似有问题</p>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"JAVA\"><figure class=\"iseeu highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.BufferedReader;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.InputStreamReader;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.OutputStreamWriter;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.UnsupportedEncodingException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.URL;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.URLConnection;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.URLEncoder;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Map;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> Kai</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Connector</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">GET</span><span class=\"params\">(String address, Map&lt;String, String&gt; params)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        String param = <span class=\"keyword\">this</span>.buildParams(params);</span><br><span class=\"line\">        URL url = <span class=\"keyword\">new</span> URL(address + <span class=\"string\">\"?\"</span> + param);</span><br><span class=\"line\">        URLConnection conn = url.openConnection();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.readData(conn);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">GET</span><span class=\"params\">(String address, String params)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        URL url = <span class=\"keyword\">new</span> URL(address + <span class=\"string\">\"?\"</span> + params);</span><br><span class=\"line\">        URLConnection conn = url.openConnection();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.readData(conn);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">POST</span><span class=\"params\">(String address, Map&lt;String, String&gt; params)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        String param = <span class=\"keyword\">this</span>.buildParams(params);</span><br><span class=\"line\">        URL url = <span class=\"keyword\">new</span> URL(address);</span><br><span class=\"line\">        URLConnection conn = url.openConnection();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.postData(conn, param);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.readData(conn);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">POST</span><span class=\"params\">(String address, String param)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        URL url = <span class=\"keyword\">new</span> URL(address);</span><br><span class=\"line\">        URLConnection conn = url.openConnection();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.postData(conn, param);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.readData(conn);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> String <span class=\"title\">buildParams</span><span class=\"params\">(Map&lt;String, String&gt; params)</span> <span class=\"keyword\">throws</span> UnsupportedEncodingException </span>&#123;</span><br><span class=\"line\">        StringBuilder sb = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Map.Entry&lt;String, String&gt; param : params.entrySet()) &#123;</span><br><span class=\"line\">            sb.append(param.getKey()).append(<span class=\"string\">\"=\"</span>);</span><br><span class=\"line\">            sb.append(URLEncoder.encode(param.getValue(), <span class=\"string\">\"UTF-8\"</span>));</span><br><span class=\"line\">            sb.append(<span class=\"string\">\"&amp;\"</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> sb.toString();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">postData</span><span class=\"params\">(<span class=\"keyword\">final</span> URLConnection conn, String requestData)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        conn.setDoOutput(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">        OutputStreamWriter wr = <span class=\"keyword\">new</span> OutputStreamWriter(conn.getOutputStream());</span><br><span class=\"line\">        wr.write(requestData);</span><br><span class=\"line\">        wr.flush();</span><br><span class=\"line\">        wr.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> String <span class=\"title\">readData</span><span class=\"params\">(<span class=\"keyword\">final</span> URLConnection conn)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        String responseData = <span class=\"string\">\"\"</span>;</span><br><span class=\"line\">        BufferedReader rd = <span class=\"keyword\">new</span> BufferedReader(<span class=\"keyword\">new</span> InputStreamReader(conn.getInputStream(), <span class=\"string\">\"UTF-8\"</span>));</span><br><span class=\"line\">        String line;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> ((line = rd.readLine()) != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            responseData += line;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        responseData = <span class=\"keyword\">new</span> String(responseData.getBytes(), <span class=\"string\">\"UTF-8\"</span>);</span><br><span class=\"line\">        rd.close();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> responseData;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div>\n<p>做个代码记录 Maven引用<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"XML\"><figure class=\"iseeu highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.httpcomponents<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>httpclient<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>4.4<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.httpcomponents<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>httpcore<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>4.4<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.httpcomponents<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>httpcore-nio<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>4.4<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></div></p>\n","text":"使用HTTPClient进行操作,可以忽略SSL1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br","link":"","raw":null,"photos":[],"categories":[{"name":"java","slug":"java","count":21,"path":"api/categories/java.json"},{"name":"http","slug":"java/http","count":1,"path":"api/categories/java/http.json"}],"tags":[{"name":"java","slug":"java","count":25,"path":"api/tags/java.json"},{"name":"http","slug":"http","count":1,"path":"api/tags/http.json"}]},{"title":"Java的Web项目使用DWR简单配置说明","slug":"Java的Web项目使用DWR简单配置说明","date":"2018-12-11T10:35:07.000Z","updated":"2018-12-11T10:35:07.372Z","comments":true,"path":"api/articles/Java的Web项目使用DWR简单配置说明.json","excerpt":"","keywords":null,"cover":null,"content":"<p>首先使用Maven引入DWR的Jar包<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"XML\"><figure class=\"iseeu highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.directwebremoting<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>dwr<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.0.1-RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></div></p>\n<p>其次建立一个测试用的Java类</p>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"JAVA\"><figure class=\"iseeu highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> Kai</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Date</span> 2016-1-7 14:32:08</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestDwr</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">getName</span><span class=\"params\">(String name)</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Call GetName Method!\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"Hello:\"</span> + name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div>\n<p>然后配置dwr.xml<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"XML\"><figure class=\"iseeu highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span></span><br><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE dwr PUBLIC \"-//GetAhead Limited//DTD Direct Web Remoting 3.0//EN\" \"http://directwebremoting.org/schema/dwr30.dtd\"&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dwr</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">allow</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">create</span> <span class=\"attr\">creator</span>=<span class=\"string\">\"new\"</span> <span class=\"attr\">javascript</span>=<span class=\"string\">\"test\"</span> <span class=\"attr\">scope</span>=<span class=\"string\">\"page\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">param</span> <span class=\"attr\">name</span>=<span class=\"string\">\"class\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"com.k.ctc.web.dwr.TestDwr\"</span> /&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">create</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">allow</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dwr</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">配置web.xml</span><br><span class=\"line\">```xml</span><br><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">web-app</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">\"http://xmlns.jcp.org/xml/ns/javaee\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">xmlns:xsi</span>=<span class=\"string\">\"http://www.w3.org/2001/XMLSchema-instance\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">xsi:schemaLocation</span>=<span class=\"string\">\"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">version</span>=<span class=\"string\">\"3.1\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">servlet</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">servlet-name</span>&gt;</span>dwr-invoker<span class=\"tag\">&lt;/<span class=\"name\">servlet-name</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">servlet-class</span>&gt;</span>org.directwebremoting.servlet.DwrServlet<span class=\"tag\">&lt;/<span class=\"name\">servlet-class</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>debug<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">            <span class=\"comment\">&lt;!-- 如果改为false将会能接收其它域的请求，存在安全风险 --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>crossDomainSessionSecurity<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">            <span class=\"comment\">&lt;!-- 设置超时时间 --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>scriptSessionTimeout<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>1800000<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>maxCallCount<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>20<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>config-xml<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>/WEB-INF/conf/dwr.xml<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">servlet</span>&gt;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">servlet-mapping</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">servlet-name</span>&gt;</span>dwr-invoker<span class=\"tag\">&lt;/<span class=\"name\">servlet-name</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">url-pattern</span>&gt;</span>/dwr/*<span class=\"tag\">&lt;/<span class=\"name\">url-pattern</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">servlet-mapping</span>&gt;</span></span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure></div></p>\n<p>最后在HTML页面中使用<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"HTML\"><figure class=\"iseeu highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Dwr Test Demo<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">http-equiv</span>=<span class=\"string\">\"Content-Type\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"text/html; charset=UTF-8\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">'text/javascript'</span> <span class=\"attr\">src</span>=<span class=\"string\">'/dwr/engine.js'</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">'text/javascript'</span> <span class=\"attr\">src</span>=<span class=\"string\">'/dwr/interface/test.js'</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">            <span class=\"keyword\">var</span> reply = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">data</span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">                <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">\"result\"</span>).innerText = data;</span></span><br><span class=\"line\"><span class=\"undefined\">            &#125;;</span></span><br><span class=\"line\"><span class=\"javascript\">            <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">btn_click</span>(<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">                <span class=\"keyword\">var</span> name = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">\"name\"</span>).value;</span></span><br><span class=\"line\"><span class=\"undefined\">                test.getName(name, reply);</span></span><br><span class=\"line\"><span class=\"undefined\">            &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">        </span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"name\"</span>/&gt;</span> <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"GetName\"</span> <span class=\"attr\">onclick</span>=<span class=\"string\">\"btn_click();\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"result\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div></p>\n<p>注意:js的路径需要引用正确,附带说明截图<br>↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓ 写好后的测试页面 ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓<br>![image][<a href=\"http://static.oschina.net/uploads/space/2016/0107/151242_zpre_2370543.png]\" target=\"_blank\" rel=\"noopener\">http://static.oschina.net/uploads/space/2016/0107/151242_zpre_2370543.png]</a></p>\n<p>↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓ DWR生成的模块列表页面 ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓<br>![image][<a href=\"http://static.oschina.net/uploads/space/2016/0107/151242_fqmL_2370543.png]\" target=\"_blank\" rel=\"noopener\">http://static.oschina.net/uploads/space/2016/0107/151242_fqmL_2370543.png]</a></p>\n<p>↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓ 模块详情页面和需要引用的js路径说明等 ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓<br>![image][<a href=\"http://static.oschina.net/uploads/space/2016/0107/151242_L64D_2370543.jpg]\" target=\"_blank\" rel=\"noopener\">http://static.oschina.net/uploads/space/2016/0107/151242_L64D_2370543.jpg]</a></p>\n","text":"首先使用Maven引入DWR的Jar包<br>1<br>2<br>3<br>4<br>5<br>&lt;dependency&gt;<br>    &lt;groupId&gt;org.directwebremoting&lt;/groupId&gt;<br>    &lt;ar","link":"","raw":null,"photos":[],"categories":[{"name":"java","slug":"java","count":21,"path":"api/categories/java.json"},{"name":"web","slug":"java/web","count":1,"path":"api/categories/java/web.json"},{"name":"dwr","slug":"java/web/dwr","count":1,"path":"api/categories/java/web/dwr.json"}],"tags":[{"name":"java","slug":"java","count":25,"path":"api/tags/java.json"},{"name":"web","slug":"web","count":1,"path":"api/tags/web.json"},{"name":"dwr","slug":"dwr","count":1,"path":"api/tags/dwr.json"}]},{"title":"使用HttpAsyncClient进行异步获取数据","slug":"使用HttpAsyncClient进行异步获取数据","date":"2018-12-11T10:33:13.000Z","updated":"2018-12-11T10:33:13.744Z","comments":true,"path":"api/articles/使用HttpAsyncClient进行异步获取数据.json","excerpt":"","keywords":null,"cover":null,"content":"<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"JAVA\"><figure class=\"iseeu highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.CountDownLatch;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.http.HttpResponse;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.http.client.config.RequestConfig;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.http.client.methods.HttpGet;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.http.concurrent.FutureCallback;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.http.impl.nio.client.CloseableHttpAsyncClient;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.http.impl.nio.client.HttpAsyncClients;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> Kai</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Date</span> 2016-1-6 11:14:56</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Desc</span></span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AsyncClient</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 设置HTTP请求的超时配置</span></span><br><span class=\"line\">        RequestConfig config = RequestConfig.custom().setSocketTimeout(<span class=\"number\">3000</span>).setConnectTimeout(<span class=\"number\">3000</span>).build();</span><br><span class=\"line\">        <span class=\"comment\">// 根据配置创建异步的HTTP客户端</span></span><br><span class=\"line\">        CloseableHttpAsyncClient httpclient = HttpAsyncClients.custom().setDefaultRequestConfig(config).build();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//运行客户端</span></span><br><span class=\"line\">        httpclient.start();</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//构建5个HTTPGET请求</span></span><br><span class=\"line\">        HttpGet[] requests = <span class=\"keyword\">new</span> HttpGet[]&#123;</span><br><span class=\"line\">            <span class=\"keyword\">new</span> HttpGet(<span class=\"string\">\"https://www.baidu.com/\"</span>),</span><br><span class=\"line\">            <span class=\"keyword\">new</span> HttpGet(<span class=\"string\">\"https://www.baidu.com/\"</span>),</span><br><span class=\"line\">            <span class=\"keyword\">new</span> HttpGet(<span class=\"string\">\"https://www.baidu.com/\"</span>),</span><br><span class=\"line\">            <span class=\"keyword\">new</span> HttpGet(<span class=\"string\">\"https://www.baidu.com/\"</span>),</span><br><span class=\"line\">            <span class=\"keyword\">new</span> HttpGet(<span class=\"string\">\"https://www.baidu.com/\"</span>)&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//创建一个计数器</span></span><br><span class=\"line\">        <span class=\"keyword\">final</span> CountDownLatch latch = <span class=\"keyword\">new</span> CountDownLatch(requests.length);</span><br><span class=\"line\">        <span class=\"comment\">//循环请求</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">final</span> HttpGet get : requests) &#123;</span><br><span class=\"line\">            httpclient.execute(get, <span class=\"keyword\">new</span> FutureCallback&lt;HttpResponse&gt;() &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"meta\">@Override</span></span><br><span class=\"line\">                <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">completed</span><span class=\"params\">(HttpResponse t)</span> </span>&#123;</span><br><span class=\"line\">                    latch.countDown();</span><br><span class=\"line\">                    System.out.println(<span class=\"string\">\"==================================\"</span>);</span><br><span class=\"line\">                    System.out.println(t.getStatusLine());</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"meta\">@Override</span></span><br><span class=\"line\">                <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">failed</span><span class=\"params\">(Exception excptn)</span> </span>&#123;</span><br><span class=\"line\">                    latch.countDown();</span><br><span class=\"line\">                    System.out.println(<span class=\"string\">\"HttpGet failed\"</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                <span class=\"meta\">@Override</span></span><br><span class=\"line\">                <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">cancelled</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">                    latch.countDown();</span><br><span class=\"line\">                    System.out.println(<span class=\"string\">\"HttpGet cancelled\"</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">//等待5个都请求完成</span></span><br><span class=\"line\">        latch.await();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Shutting down\"</span>);</span><br><span class=\"line\">        <span class=\"comment\">//关闭</span></span><br><span class=\"line\">        httpclient.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div>\n<p>以下是使用Maven引用的jar(并不知道是不是都有使用到):<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"XML\"><figure class=\"iseeu highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\">     <span class=\"tag\">&lt;<span class=\"name\">httpclient.version</span>&gt;</span>4.4<span class=\"tag\">&lt;/<span class=\"name\">httpclient.version</span>&gt;</span></span><br><span class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"comment\">&lt;!-- HTTP CLIENT START --&gt;</span></span><br><span class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.httpcomponents<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>httpasyncclient<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>4.1<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.httpcomponents<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>httpclient<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;httpclient.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.httpcomponents<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>httpcore<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;httpclient.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.httpcomponents<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>httpcore-nio<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;httpclient.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- HTTP CLIENT END --&gt;</span></span><br></pre></td></tr></table></figure></div></p>\n","text":"1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br","link":"","raw":null,"photos":[],"categories":[{"name":"java","slug":"java","count":21,"path":"api/categories/java.json"},{"name":"httpclient","slug":"java/httpclient","count":1,"path":"api/categories/java/httpclient.json"}],"tags":[{"name":"java","slug":"java","count":25,"path":"api/tags/java.json"},{"name":"httpclient","slug":"httpclient","count":1,"path":"api/tags/httpclient.json"}]},{"title":"一些SQL语句的收集","slug":"一些SQL语句的收集","date":"2018-12-11T10:32:25.000Z","updated":"2018-12-11T10:32:25.720Z","comments":true,"path":"api/articles/一些SQL语句的收集.json","excerpt":"","keywords":null,"cover":null,"content":"<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"SQL\"><figure class=\"iseeu highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">---Mysql查询表的容量</span></span><br><span class=\"line\"><span class=\"keyword\">use</span> information_schema;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">select</span> table_name,<span class=\"keyword\">concat</span>(<span class=\"keyword\">round</span>((data_length+index_length)/<span class=\"number\">1024</span>/<span class=\"number\">1024</span>/<span class=\"number\">1024</span>),<span class=\"string\">'GB'</span>) <span class=\"keyword\">as</span> table_capacity,table_rows <span class=\"keyword\">from</span> <span class=\"keyword\">tables</span> <span class=\"keyword\">where</span> table_schema=<span class=\"string\">'db_name'</span> <span class=\"keyword\">order</span> <span class=\"keyword\">by</span> table_capacity <span class=\"keyword\">desc</span>;</span><br></pre></td></tr></table></figure></div>\n","text":"1<br>2<br>3<br>4<br>---Mysql查询表的容量<br>use information_schema;<br><br>select table_name,concat(round((data_length+index_length)/1024/1024/102","link":"","raw":null,"photos":[],"categories":[{"name":"sql","slug":"sql","count":1,"path":"api/categories/sql.json"}],"tags":[{"name":"sql","slug":"sql","count":1,"path":"api/tags/sql.json"}]},{"title":"Linux安装Redis,并用Java进行操作","slug":"Linux安装Redis-并用Java进行操作","date":"2018-12-11T10:32:02.000Z","updated":"2018-12-11T10:32:02.380Z","comments":true,"path":"api/articles/Linux安装Redis-并用Java进行操作.json","excerpt":"","keywords":null,"cover":null,"content":"<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">## 进入目录</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> /opt/app/redis</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 下载Redis</span></span><br><span class=\"line\">wget http://download.redis.io/releases/redis-3.0.7.tar.gz</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 改权限?</span></span><br><span class=\"line\">chmod -R 777 redis-3.0.5.tar.gz</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 解压</span></span><br><span class=\"line\">tar xzf redis-3.0.5.tar.gz</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 进入Redis的目录</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> redis-3.0.5</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 安装到指定目录</span></span><br><span class=\"line\">make MALLOC=libc PREFIX=/opt/app/redis install </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 如果安装失败,缺少GCC 则需要先安装 GCC</span></span><br><span class=\"line\">yum install -y gcc</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 安装成功后进入到 /opt/app/redis/cont/bin 目录可以看到如下文件</span></span><br><span class=\"line\"></span><br><span class=\"line\">redis-benchmark</span><br><span class=\"line\">redis-check-aof</span><br><span class=\"line\">redis-check-dump</span><br><span class=\"line\">redis-cli</span><br><span class=\"line\">redis-sentinel -&gt; redis-server</span><br><span class=\"line\">redis-server</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 后台启动Redis服务</span></span><br><span class=\"line\">./redis-server &amp;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 测试连接</span></span><br><span class=\"line\">./redis-cli</span><br><span class=\"line\"></span><br><span class=\"line\">127.0.0.1:6379&gt; <span class=\"built_in\">set</span> a b</span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; get a</span><br><span class=\"line\"><span class=\"string\">\"b\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 到此Redis的安装和启动完成</span></span><br></pre></td></tr></table></figure></div>\n<p>测试Java使用Redis<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"XML\"><figure class=\"iseeu highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// 使用Maven引入支持的Jar</span><br><span class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span>  </span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>redis.clients<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span>  </span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>jedis<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span>  </span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.8.0<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span>  </span><br><span class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></div></p>\n <div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"JAVA\"><figure class=\"iseeu highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//测试方法</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] params)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">       Jedis jedis = <span class=\"keyword\">new</span> Jedis(<span class=\"string\">\"127.0.0.1\"</span>);</span><br><span class=\"line\">       jedis.set(<span class=\"string\">\"a\"</span>, <span class=\"string\">\"b....\"</span>);</span><br><span class=\"line\">       System.out.println(<span class=\"string\">\"================================================\"</span>);</span><br><span class=\"line\">       System.out.println(jedis.get(<span class=\"string\">\"a\"</span>));</span><br><span class=\"line\">       System.out.println(<span class=\"string\">\"================================================\"</span>);</span><br><span class=\"line\">       jedis.rename(<span class=\"string\">\"a\"</span>, <span class=\"string\">\"a1\"</span>);</span><br><span class=\"line\">       System.out.println(jedis.get(<span class=\"string\">\"a\"</span>));</span><br><span class=\"line\">       System.out.println(<span class=\"string\">\"================================================\"</span>);</span><br><span class=\"line\">       System.out.println(jedis.get(<span class=\"string\">\"a1\"</span>));</span><br><span class=\"line\">       System.out.println(<span class=\"string\">\"================================================\"</span>);</span><br><span class=\"line\">       jedis.del(<span class=\"string\">\"a1\"</span>);</span><br><span class=\"line\">       System.out.println(jedis.get(<span class=\"string\">\"a1\"</span>));</span><br><span class=\"line\">       System.out.println(<span class=\"string\">\"================================================\"</span>);</span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure></div>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//  运行结果</span><br><span class=\"line\"></span><br><span class=\"line\">================================================</span><br><span class=\"line\">b....</span><br><span class=\"line\">================================================</span><br><span class=\"line\">null</span><br><span class=\"line\">================================================</span><br><span class=\"line\">b....</span><br><span class=\"line\">================================================</span><br><span class=\"line\">null</span><br><span class=\"line\">================================================</span><br></pre></td></tr></table></figure></div>","text":"1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br","link":"","raw":null,"photos":[],"categories":[{"name":"Centos","slug":"Centos","count":30,"path":"api/categories/Centos.json"},{"name":"java","slug":"Centos/java","count":2,"path":"api/categories/Centos/java.json"},{"name":"redis","slug":"Centos/java/redis","count":1,"path":"api/categories/Centos/java/redis.json"}],"tags":[{"name":"Centos","slug":"Centos","count":29,"path":"api/tags/Centos.json"},{"name":"java","slug":"java","count":25,"path":"api/tags/java.json"},{"name":"redis","slug":"redis","count":3,"path":"api/tags/redis.json"}]},{"title":"Java使用GoogleProtocolBuffer简单说明","slug":"Java使用GoogleProtocolBuffer简单说明","date":"2018-12-11T10:30:34.000Z","updated":"2018-12-11T10:30:34.117Z","comments":true,"path":"api/articles/Java使用GoogleProtocolBuffer简单说明.json","excerpt":"","keywords":null,"cover":null,"content":"<p>![image][<a href=\"http://static.oschina.net/uploads/space/2015/1203/145344_36DW_2370543.png]\" target=\"_blank\" rel=\"noopener\">http://static.oschina.net/uploads/space/2015/1203/145344_36DW_2370543.png]</a></p>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">###关于数据结构文件的描述符的含义</span></span><br><span class=\"line\">1.required  （表示必须存在）</span><br><span class=\"line\">2.optional  （表示可选，不一定需要有值）</span><br><span class=\"line\">3.repeated  （表示集合类）</span><br><span class=\"line\"><span class=\"comment\">###定义一个简单的数据结构</span></span><br></pre></td></tr></table></figure></div>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"JAVA\"><figure class=\"iseeu highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.test;</span><br><span class=\"line\"></span><br><span class=\"line\">option java_outer_classname = <span class=\"string\">\"PersonData\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">message person &#123;  </span><br><span class=\"line\">    <span class=\"comment\">// ID（必需）  </span></span><br><span class=\"line\">    required int32 id = <span class=\"number\">1</span>;  </span><br><span class=\"line\">    <span class=\"comment\">// 姓名（必需）  </span></span><br><span class=\"line\">    required string name = <span class=\"number\">2</span> [<span class=\"keyword\">default</span> = <span class=\"string\">'Test'</span>]; </span><br><span class=\"line\">    <span class=\"comment\">// 年龄（可选）  </span></span><br><span class=\"line\">    optional string age= <span class=\"number\">3</span>;  </span><br><span class=\"line\">    <span class=\"comment\">// 朋友的引用（集合）  </span></span><br><span class=\"line\">    repeated int32 ids= <span class=\"number\">4</span> [packed=<span class=\"keyword\">true</span>];  </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">### 使用protoc工具转换为Java类</span></span><br><span class=\"line\"><span class=\"comment\">###参数：-I 表示结构文件所在的目录，</span></span><br><span class=\"line\"><span class=\"comment\">####    --java_out 表示输出的文件目录</span></span><br><span class=\"line\"><span class=\"comment\">####  第三个参数person.proto 表示使用的是哪个结构文件</span></span><br><span class=\"line\"></span><br><span class=\"line\">protoc -I=.\\ --java_out=.\\ person.proto</span><br></pre></td></tr></table></figure></div>\n<p>转换完成后把java文件考入对应的java包中，并在项目中引入</p>\n<p>GoogleProtocolBuffer的使用jar包<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"XML\"><figure class=\"iseeu highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.google.protobuf<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>protobuf-java<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.6.1<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></div></p>\n<p>以下是生成后的Java测试:<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"JAVA\"><figure class=\"iseeu highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.k.ctc.code;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.test.PersonData;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> Kai</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Date</span> 2015-11-23 17:54:48</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@Desc</span></span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MainLauncher</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] params)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">long</span> time1 = System.currentTimeMillis();</span><br><span class=\"line\">        PersonData.person p = PersonData.person.newBuilder().setId(<span class=\"number\">1</span>).setAge(<span class=\"string\">\"18\"</span>).setName(<span class=\"string\">\"LiLei\"</span>).build();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"======================================\"</span>);</span><br><span class=\"line\">        System.out.println(p);</span><br><span class=\"line\">        <span class=\"keyword\">byte</span>[] bytes = p.toByteArray();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"======================================\"</span>);</span><br><span class=\"line\">        System.out.println(bytes.length);</span><br><span class=\"line\">        PersonData.person p1 = PersonData.person.parseFrom(bytes);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"======================================\"</span>);</span><br><span class=\"line\">        System.out.println(p1);</span><br><span class=\"line\">        <span class=\"keyword\">long</span> time2 = System.currentTimeMillis();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"======================================\"</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"time:\"</span> + (time2 - time1));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div></p>\n<p>执行结果是:<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">======================================</span><br><span class=\"line\">id: 1</span><br><span class=\"line\">name: <span class=\"string\">\"LiLei\"</span></span><br><span class=\"line\">age: <span class=\"string\">\"18\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">======================================</span><br><span class=\"line\">13</span><br><span class=\"line\">======================================</span><br><span class=\"line\">id: 1</span><br><span class=\"line\">name: <span class=\"string\">\"LiLei\"</span></span><br><span class=\"line\">age: <span class=\"string\">\"18\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">======================================</span><br><span class=\"line\">time:125</span><br></pre></td></tr></table></figure></div></p>\n","text":"![image][http://static.oschina.net/uploads/space/2015/1203/145344_36DW_2370543.png]1<br>2<br>3<br>4<br>5<br>###关于数据结构文件的描述符的含义<br>1.required","link":"","raw":null,"photos":[],"categories":[{"name":"java","slug":"java","count":21,"path":"api/categories/java.json"},{"name":"protobuf","slug":"java/protobuf","count":1,"path":"api/categories/java/protobuf.json"}],"tags":[{"name":"java","slug":"java","count":25,"path":"api/tags/java.json"},{"name":"protobuf","slug":"protobuf","count":1,"path":"api/tags/protobuf.json"}]},{"title":"游戏类别相关简称","slug":"游戏类别相关简称","date":"2018-12-11T10:28:52.000Z","updated":"2018-12-11T10:28:52.516Z","comments":true,"path":"api/articles/游戏类别相关简称.json","excerpt":"","keywords":null,"cover":null,"content":"<p>ACT:动作游戏<br>A-RPG:动作角色扮演游戏<br>AVG:冒险游戏<br>A-AVG:动作冒险游戏<br>EDU:养成类游戏<br>FLY:模拟飞行<br>FPS:第一人称视角射击游戏<br>FTG:格斗游戏<br>MIX:合成类游戏<br>MMO-RPG:大型多人在线角色扮演游戏<br>MUD:网络游戏<br>MUG:音乐游戏<br>OTH:其他类游戏<br>PUZ:益智类游戏<br>RAC:赛车类游戏<br>RPG:角色扮演游戏<br>RTS:即时战略游戏<br>SIM:模拟经营<br>SLG:策略战棋游戏<br>SPG:运动游戏<br>S-RPG:战略角色扮演游戏<br>SPT:体育游戏<br>STG:射击游戏<br>TAB:桌面棋类游戏</p>\n","text":"ACT:动作游戏<br>A-RPG:动作角色扮演游戏<br>AVG:冒险游戏<br>A-AVG:动作冒险游戏<br>EDU:养成类游戏<br>FLY:模拟飞行<br>FPS:第一人称视角射击游戏<br>FTG:格斗游戏<br>MIX:合成类游戏<br>MMO-RPG:大型多人在线","link":"","raw":null,"photos":[],"categories":[{"name":"game","slug":"game","count":1,"path":"api/categories/game.json"},{"name":"游戏类别","slug":"game/游戏类别","count":1,"path":"api/categories/game/游戏类别.json"}],"tags":[{"name":"game","slug":"game","count":1,"path":"api/tags/game.json"},{"name":"游戏类别","slug":"游戏类别","count":1,"path":"api/tags/游戏类别.json"}]},{"title":"Java读取HttpServletRequest的post数据流","slug":"Java读取HttpServletRequest的post数据流","date":"2018-12-11T10:28:18.000Z","updated":"2018-12-11T10:28:18.365Z","comments":true,"path":"api/articles/Java读取HttpServletRequest的post数据流.json","excerpt":"","keywords":null,"cover":null,"content":"<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"JAVA\"><figure class=\"iseeu highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">readPostData</span><span class=\"params\">(HttpServletRequest request)</span> </span>&#123;</span><br><span class=\"line\">        StringBuilder result = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            String line;</span><br><span class=\"line\">            BufferedReader reader = request.getReader();</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"keyword\">null</span> != (line = reader.readLine())) &#123;</span><br><span class=\"line\">                result.append(line);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            Log.info(e.getMessage());</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> result.toString();</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure></div>\n","text":"1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>public String readPostData(HttpServletRequest request) &#123;<br>      ","link":"","raw":null,"photos":[],"categories":[{"name":"java","slug":"java","count":21,"path":"api/categories/java.json"},{"name":"readpost","slug":"java/readpost","count":1,"path":"api/categories/java/readpost.json"}],"tags":[{"name":"java","slug":"java","count":25,"path":"api/tags/java.json"},{"name":"post","slug":"post","count":1,"path":"api/tags/post.json"},{"name":"request","slug":"request","count":1,"path":"api/tags/request.json"}]},{"title":"通过Java操作ActiveMQ的代码记录","slug":"通过Java操作ActiveMQ的代码记录","date":"2018-12-11T10:27:40.000Z","updated":"2018-12-11T10:27:40.790Z","comments":true,"path":"api/articles/通过Java操作ActiveMQ的代码记录.json","excerpt":"","keywords":null,"cover":null,"content":"<p>ActiveMQ的数据发送类<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"JAVA\"><figure class=\"iseeu highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> javax.jms.DeliveryMode;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.jms.Destination;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.jms.MessageProducer;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.jms.Session;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.jms.TextMessage;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.activemq.ActiveMQConnectionFactory;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.activemq.pool.PooledConnection;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.activemq.pool.PooledConnectionFactory;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ActiveMQSend</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> String ip;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> String port;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> PooledConnection pooledConnection;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 构造方法（传入需要连接的IP和端口）</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> ip （AvctiveMQ的服务IP）</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> port （ActiveMQ的服务端口）</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">ActiveMQSend</span><span class=\"params\">(String ip, String port)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.ip = ip;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.port = port;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.init();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 初始化ActiveMQ的连接池</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            String[] ips = <span class=\"keyword\">this</span>.ip.split(<span class=\"string\">\",\"</span>);</span><br><span class=\"line\">            String[] ports = <span class=\"keyword\">this</span>.port.split(<span class=\"string\">\",\"</span>);</span><br><span class=\"line\">            StringBuilder tcpLink = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; ips.length; i++) &#123;</span><br><span class=\"line\">                tcpLink.append(<span class=\"string\">\"tcp://\"</span>).append(ips[i]).append(<span class=\"string\">\":\"</span>).append(ports[i]).append(<span class=\"string\">\",\"</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            String mqLink = tcpLink.toString();</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (tcpLink.length() &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (<span class=\"string\">','</span> == tcpLink.charAt(tcpLink.length() - <span class=\"number\">1</span>)) &#123;</span><br><span class=\"line\">                    mqLink = tcpLink.substring(<span class=\"number\">0</span>, tcpLink.length() - <span class=\"number\">1</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            String url = String.format(<span class=\"string\">\"failover:(%s)?initialReconnectDelay=1000&amp;timeout=3000&amp;startupMaxReconnectAttempts=2\"</span>, mqLink);</span><br><span class=\"line\">            ActiveMQConnectionFactory factory = <span class=\"keyword\">new</span> ActiveMQConnectionFactory(url);</span><br><span class=\"line\">            factory.setMaxThreadPoolSize(<span class=\"number\">50</span>);</span><br><span class=\"line\">            PooledConnectionFactory poolFactory = <span class=\"keyword\">new</span> PooledConnectionFactory(factory);</span><br><span class=\"line\">            pooledConnection = (PooledConnection) poolFactory.createConnection();</span><br><span class=\"line\">            pooledConnection.start();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception ex) &#123;</span><br><span class=\"line\">            LogUtil.error(ex);</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.destroy();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 向ActiveMQ中发送数据</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> needSendMsg 需要发送的数据信息</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> sendMQName 需要发送到的队列名称</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">send</span><span class=\"params\">(String needSendMsg, String sendMQName)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.pooledConnection == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.init();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.pooledConnection != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                Session session = <span class=\"keyword\">this</span>.pooledConnection.createSession(Boolean.FALSE, Session.AUTO_ACKNOWLEDGE);</span><br><span class=\"line\">                Destination destination = session.createQueue(sendMQName);</span><br><span class=\"line\">                MessageProducer producer = session.createProducer(destination);</span><br><span class=\"line\">                producer.setDeliveryMode(DeliveryMode.PERSISTENT);</span><br><span class=\"line\">                TextMessage message = session.createTextMessage(needSendMsg);</span><br><span class=\"line\">                producer.send(message);</span><br><span class=\"line\">                session.close();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (Exception ex) &#123;</span><br><span class=\"line\">                LogUtil.error(ex);</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.destroy();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 回收连接池</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">destroy</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (pooledConnection != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                pooledConnection.stop();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            LogUtil.error(e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (pooledConnection != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                pooledConnection.close();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            LogUtil.error(e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        pooledConnection = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div></p>\n<p>调用发送<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"JAVA\"><figure class=\"iseeu highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        Thread t1 = <span class=\"keyword\">new</span> Thread(<span class=\"keyword\">new</span> Runnable() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">                ActiveMQSend sen = <span class=\"keyword\">new</span> ActiveMQSend(<span class=\"string\">\"127.0.0.1\"</span>, <span class=\"string\">\"61616\"</span>);</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">50000</span>; i++) &#123;</span><br><span class=\"line\">                    String msg = String.format(<span class=\"string\">\"这是TestQueue 2 第 %s 条发送的数据！\"</span>, i);</span><br><span class=\"line\">                    sen.send(msg, <span class=\"string\">\"TestQueue2\"</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        Thread t2 = <span class=\"keyword\">new</span> Thread(<span class=\"keyword\">new</span> Runnable() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">                ActiveMQSend sen = <span class=\"keyword\">new</span> ActiveMQSend(<span class=\"string\">\"127.0.0.1\"</span>, <span class=\"string\">\"61616\"</span>);</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">50000</span>; i++) &#123;</span><br><span class=\"line\">                    String msg = String.format(<span class=\"string\">\"这是TestQueue 1 第 %s 条发送的数据！\"</span>, i);</span><br><span class=\"line\">                    sen.send(msg, <span class=\"string\">\"TestQueue1\"</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        t2.start();</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure></div></p>\n<p>ActiveMQ数据接收类<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"JAVA\"><figure class=\"iseeu highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> javax.jms.MessageConsumer;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.jms.Destination;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.jms.Session;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.jms.TextMessage;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.activemq.ActiveMQConnectionFactory;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.activemq.pool.PooledConnection;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.activemq.pool.PooledConnectionFactory;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Receiver</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> PooledConnection pooledConnection;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">init</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            String url = <span class=\"string\">\"failover:(tcp://192.168.10.219:61616)?initialReconnectDelay=1000&amp;timeout=3000&amp;startupMaxReconnectAttempts=2\"</span>;</span><br><span class=\"line\">            ActiveMQConnectionFactory factory = <span class=\"keyword\">new</span> ActiveMQConnectionFactory(url);</span><br><span class=\"line\">            factory.setMaxThreadPoolSize(<span class=\"number\">100</span>);</span><br><span class=\"line\">            PooledConnectionFactory poolFactory = <span class=\"keyword\">new</span> PooledConnectionFactory(factory);</span><br><span class=\"line\">            pooledConnection = (PooledConnection) poolFactory.createConnection();</span><br><span class=\"line\">            pooledConnection.start();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception ex) &#123;</span><br><span class=\"line\">            Log.error(ex);</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.destroy();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">receive</span><span class=\"params\">(String queueName)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.pooledConnection == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.init();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.pooledConnection != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                Session session = <span class=\"keyword\">this</span>.pooledConnection.createSession(Boolean.FALSE, Session.AUTO_ACKNOWLEDGE);</span><br><span class=\"line\">                Destination destination = session.createQueue(queueName);</span><br><span class=\"line\">                MessageConsumer consumer = session.createConsumer(destination);</span><br><span class=\"line\">                <span class=\"keyword\">while</span> (<span class=\"keyword\">true</span>) &#123;</span><br><span class=\"line\">                    TextMessage message = (TextMessage) consumer.receive(<span class=\"number\">10</span>);</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != message) &#123;</span><br><span class=\"line\">                        System.out.println(<span class=\"string\">\"收到消息\"</span> + message.getText());</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (Exception ex) &#123;</span><br><span class=\"line\">                Log.info(ex.getMessage());</span><br><span class=\"line\">                <span class=\"keyword\">this</span>.destroy();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">destroy</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (pooledConnection != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                pooledConnection.stop();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            Log.error(e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (pooledConnection != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                pooledConnection.close();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            Log.error(e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        pooledConnection = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div></p>\n<p>数据接收类的调用<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"JAVA\"><figure class=\"iseeu highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        Thread t1 = <span class=\"keyword\">new</span> Thread(<span class=\"keyword\">new</span> Runnable() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">                Receiver r1 = <span class=\"keyword\">new</span> Receiver();</span><br><span class=\"line\">                r1.receive(<span class=\"string\">\"TestQueue2\"</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        Thread t2 = <span class=\"keyword\">new</span> Thread(<span class=\"keyword\">new</span> Runnable() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">                Receiver r2 = <span class=\"keyword\">new</span> Receiver();</span><br><span class=\"line\">                r2.receive(<span class=\"string\">\"TestQueue1\"</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        t1.start();</span><br><span class=\"line\">        t2.start();</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure></div></p>\n","text":"ActiveMQ的数据发送类<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br","link":"","raw":null,"photos":[],"categories":[{"name":"java","slug":"java","count":21,"path":"api/categories/java.json"},{"name":"activemq","slug":"java/activemq","count":1,"path":"api/categories/java/activemq.json"}],"tags":[{"name":"java","slug":"java","count":25,"path":"api/tags/java.json"},{"name":"activemq","slug":"activemq","count":1,"path":"api/tags/activemq.json"}]},{"title":"javax.mail发送邮件","slug":"javax-mail发送邮件","date":"2018-12-11T10:26:41.000Z","updated":"2018-12-11T10:26:41.062Z","comments":true,"path":"api/articles/javax-mail发送邮件.json","excerpt":"","keywords":null,"cover":null,"content":"<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"JAVA\"><figure class=\"iseeu highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/* @param fromMail  发送邮箱</span></span><br><span class=\"line\"><span class=\"comment\">   * @param user  发送邮箱账号</span></span><br><span class=\"line\"><span class=\"comment\">   * @param password  邮箱密码</span></span><br><span class=\"line\"><span class=\"comment\">   * @param toMail  接收邮件地址</span></span><br><span class=\"line\"><span class=\"comment\">   * @param mailTitle  邮件标题</span></span><br><span class=\"line\"><span class=\"comment\">   * @param mailContent  邮件内容</span></span><br><span class=\"line\"><span class=\"comment\">   * @throws Exception </span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">sendMail</span><span class=\"params\">(String fromMail, String user, String password, String toMail, String mailTitle, String mailContent)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">       MailSSLSocketFactory sf = <span class=\"keyword\">new</span> MailSSLSocketFactory();</span><br><span class=\"line\">       sf.setTrustAllHosts(<span class=\"keyword\">true</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">       Properties props = <span class=\"keyword\">new</span> Properties();</span><br><span class=\"line\">       props.put(<span class=\"string\">\"mail.smtp.host\"</span>, <span class=\"string\">\"mail.*****.com\"</span>);</span><br><span class=\"line\">       props.put(<span class=\"string\">\"mail.smtp.port\"</span>, <span class=\"number\">465</span>);</span><br><span class=\"line\">       props.put(<span class=\"string\">\"mail.transport.protocol\"</span>, <span class=\"string\">\"smtp\"</span>);</span><br><span class=\"line\">       props.put(<span class=\"string\">\"mail.smtp.auth\"</span>, <span class=\"string\">\"true\"</span>);</span><br><span class=\"line\">       props.put(<span class=\"string\">\"mail.smtp.ssl.enable\"</span>, <span class=\"string\">\"true\"</span>);</span><br><span class=\"line\">       props.put(<span class=\"string\">\"mail.smtp.ssl.socketFactory\"</span>, sf);</span><br><span class=\"line\"></span><br><span class=\"line\">       Session session = Session.getInstance(props);</span><br><span class=\"line\"></span><br><span class=\"line\">       MimeMessage message = <span class=\"keyword\">new</span> MimeMessage(session);</span><br><span class=\"line\">       message.setFrom(<span class=\"keyword\">new</span> InternetAddress(fromMail));</span><br><span class=\"line\">       message.setRecipient(Message.RecipientType.TO, <span class=\"keyword\">new</span> InternetAddress(toMail));</span><br><span class=\"line\">       message.setSubject(mailTitle);</span><br><span class=\"line\">       message.setText(mailContent);</span><br><span class=\"line\">       message.setSentDate(<span class=\"keyword\">new</span> Date());</span><br><span class=\"line\">       message.saveChanges();</span><br><span class=\"line\">       Transport transport = session.getTransport();</span><br><span class=\"line\">       transport.connect(user, password);</span><br><span class=\"line\">       transport.sendMessage(message, message.getAllRecipients());</span><br><span class=\"line\">       transport.close();</span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure></div>\n<p>下面是需要添加的包：<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"XML\"><figure class=\"iseeu highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>javax.mail<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mail<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.4.7<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></div></p>\n","text":"1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br","link":"","raw":null,"photos":[],"categories":[{"name":"java","slug":"java","count":21,"path":"api/categories/java.json"},{"name":"mail","slug":"java/mail","count":1,"path":"api/categories/java/mail.json"}],"tags":[{"name":"java","slug":"java","count":25,"path":"api/tags/java.json"},{"name":"mail","slug":"mail","count":1,"path":"api/tags/mail.json"}]}]}