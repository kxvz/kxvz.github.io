{"total":94,"pageSize":10,"pageCount":10,"data":[{"title":"编译安装Ruby2.3.1","slug":"编译安装Ruby2-3-1","date":"2018-12-12T02:02:57.000Z","updated":"2018-12-12T02:02:57.174Z","comments":true,"path":"api/articles/编译安装Ruby2-3-1.json","excerpt":"","keywords":null,"cover":null,"content":"<p>由于需要GCC和使用OpenSSL 所以需要先安装</p>\n<h3 id=\"安装-GCC\"><a href=\"#安装-GCC\" class=\"headerlink\" title=\"安装 GCC\"></a>安装 GCC</h3><p>sudo yum install -y gcc</p>\n<h3 id=\"安装-openssl\"><a href=\"#安装-openssl\" class=\"headerlink\" title=\"安装 openssl\"></a>安装 openssl</h3><p>下载: <a href=\"https://www.openssl.org/source/\" target=\"_blank\" rel=\"noopener\">https://www.openssl.org/source/</a></p>\n<p>安装:<br>tar -xzvf openssl-1.0.1t.tar.gz</p>\n<p>cd openssl-1.0.1t<br>./config<br>make<br>sudo make install</p>\n<p>测试: openssl</p>\n<h3 id=\"安装Ruby\"><a href=\"#安装Ruby\" class=\"headerlink\" title=\"安装Ruby\"></a>安装Ruby</h3><p>下载: <a href=\"https://cache.ruby-lang.org/pub/ruby/2.3/ruby-2.3.1.tar.gz\" target=\"_blank\" rel=\"noopener\">https://cache.ruby-lang.org/pub/ruby/2.3/ruby-2.3.1.tar.gz</a><br>安装: tar -xzvf ruby-2.3.1.tar.gz</p>\n<p>cd ruby-2.3.1<br>./configure  –with-openssl-dir=/usr/local/ssl<br>make<br>sudo make install</p>\n<p>查看: ruby -v</p>\n<h3 id=\"gem源\"><a href=\"#gem源\" class=\"headerlink\" title=\"gem源\"></a>gem源</h3><p>gem sources -l   ### 查询</p>\n<p>gem sources –remove <a href=\"https://rubygems.org/\" target=\"_blank\" rel=\"noopener\">https://rubygems.org/</a>  ## 移除</p>\n<p>gem sources -a <a href=\"https://ruby.taobao.org/\" target=\"_blank\" rel=\"noopener\">https://ruby.taobao.org/</a>   ##添加</p>\n<p>gem sources -a <a href=\"http://gems.ruby-china.org/\" target=\"_blank\" rel=\"noopener\">http://gems.ruby-china.org/</a></p>\n","text":"由于需要GCC和使用OpenSSL 所以需要先安装安装 GCCsudo yum install -y gcc安装 openssl下载: https://www.openssl.org/source/安装:<br>tar -xzvf openssl-1.0.1t.tar.gzcd ","link":"","raw":null,"photos":[],"categories":[{"name":"Centos","slug":"Centos","count":30,"path":"api/categories/Centos.json"},{"name":"ruby","slug":"Centos/ruby","count":1,"path":"api/categories/Centos/ruby.json"}],"tags":[{"name":"Centos","slug":"Centos","count":29,"path":"api/tags/Centos.json"},{"name":"install","slug":"install","count":9,"path":"api/tags/install.json"},{"name":"ruby","slug":"ruby","count":1,"path":"api/tags/ruby.json"}]},{"title":"在CentOS上制作CA证书并绑定到Nginx上","slug":"在CentOS上制作CA证书并绑定到Nginx上","date":"2018-12-12T02:02:06.000Z","updated":"2018-12-12T02:02:06.603Z","comments":true,"path":"api/articles/在CentOS上制作CA证书并绑定到Nginx上.json","excerpt":"","keywords":null,"cover":null,"content":"<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"CMD\"><figure class=\"iseeu highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//创建根证书密钥文件</span><br><span class=\"line\">openssl genrsa -des3 -out test.key</span><br><span class=\"line\">//创建根证书的申请文件</span><br><span class=\"line\">openssl req -new -key test.key -out test.csr</span><br><span class=\"line\">//创建一个自当前日期起为期十年的根证书</span><br><span class=\"line\">openssl x509 -req -days <span class=\"number\">3650</span> -sha1 -extensions v3_ca -signkey test.key -<span class=\"keyword\">in</span> test.csr -out test.crt</span><br><span class=\"line\"></span><br><span class=\"line\">//创建服务器证书密钥</span><br><span class=\"line\">openssl genrsa -des3 -out server.key <span class=\"number\">2048</span></span><br><span class=\"line\">//创建服务器证书的申请文件</span><br><span class=\"line\">openssl req -new -key server.key -out server.csr</span><br><span class=\"line\">//创建自当前日期起有效期为期两年的服务器证书</span><br><span class=\"line\">openssl x509 -req -days <span class=\"number\">730</span> -sha1 -extensions v3_req -CA test.crt -CAkey test.key -CAserial test.srl -CAcreateserial -<span class=\"keyword\">in</span> server.csr -out server.crt</span><br><span class=\"line\"></span><br><span class=\"line\">//创建客户端证书密钥文件</span><br><span class=\"line\">openssl genrsa -des3 -out client.key <span class=\"number\">2048</span></span><br><span class=\"line\">//创建客户端证书的申请文件</span><br><span class=\"line\">openssl req -new -key client.key -out client.csr</span><br><span class=\"line\">//创建一个自当前日期起有效期为两年的客户端证书</span><br><span class=\"line\">openssl x509 -req -days <span class=\"number\">730</span> -sha1 -extensions v3_req -CA test.crt -CAkey test.key -CAserial test.srl -CAcreateserial -<span class=\"keyword\">in</span> client.csr -out client.crt</span><br><span class=\"line\"></span><br><span class=\"line\">//将客户端证书文件client.crt和客户端证书密钥文件client.key合并成客户端证书安装包client.pfx</span><br><span class=\"line\">openssl pkcs12 -export -<span class=\"keyword\">in</span> client.crt -inkey client.key -out client.pfx</span><br><span class=\"line\"></span><br><span class=\"line\">//保存生成的文件备用，其中server.crt和server.key是配置单向SSL时需要使用的证书文件，client.crt是配置双向SSL时需要使用的证书文件，client.pfx是配置双向SSL时需要客户端安装的证书文件</span><br><span class=\"line\"></span><br><span class=\"line\">//证书合并</span><br><span class=\"line\">cat server.key server.crt &gt; server.pem</span><br><span class=\"line\">cat client.key client.crt &gt; client.pem</span><br><span class=\"line\"></span><br><span class=\"line\">//配置到Nginx中:</span><br><span class=\"line\"></span><br><span class=\"line\">server &#123;</span><br><span class=\"line\">    #添加<span class=\"number\">443</span>监听</span><br><span class=\"line\">    listen       <span class=\"number\">443</span>;</span><br><span class=\"line\">    #开启SSL</span><br><span class=\"line\">    ssl  on;</span><br><span class=\"line\">    #指定PEM格式的证书文件   </span><br><span class=\"line\">    ssl_certificate      /etc/nginx/conf.d/keys/server.pem;</span><br><span class=\"line\">    ssl_client_certificate     /etc/nginx/conf.d/keys/client.pem;</span><br><span class=\"line\">    ssl_certificate_key  /etc/nginx/conf.d/keys/server.key;</span><br><span class=\"line\"></span><br><span class=\"line\">    ssl_session_cache shared:SSL:<span class=\"number\">1</span>m;</span><br><span class=\"line\">    ssl_session_timeout  <span class=\"number\">5</span>m;</span><br><span class=\"line\"></span><br><span class=\"line\">    ssl_protocols SSLv2 SSLv3 TLSv1;</span><br><span class=\"line\">    ssl_ciphers  ALL:<span class=\"variable\">!ADH:!</span>EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP;</span><br><span class=\"line\">    ssl_prefer_server_ciphers   on;</span><br><span class=\"line\"></span><br><span class=\"line\">    #将所有的http请求通过rewrite重写到https上即可</span><br><span class=\"line\">    # rewrite ^(.*)$  https://$host$<span class=\"number\">1</span> permanent;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">// 所有的操作完成后需要重启 Nginx 并输入证书密码</span><br><span class=\"line\"> service nginx restart</span><br></pre></td></tr></table></figure></div>\n<p>附 nginx.conf:<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"PLAIN\"><figure class=\"iseeu highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">user nginx;</span><br><span class=\"line\">worker_processes auto;</span><br><span class=\"line\">error_log /var/log/nginx/error.log;</span><br><span class=\"line\">pid /run/nginx.pid;</span><br><span class=\"line\"></span><br><span class=\"line\">events &#123;</span><br><span class=\"line\">    worker_connections 1024;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">http &#123;</span><br><span class=\"line\">    sendfile            on;</span><br><span class=\"line\">    tcp_nopush          on;</span><br><span class=\"line\">    tcp_nodelay         on;</span><br><span class=\"line\">    keepalive_timeout   65;</span><br><span class=\"line\">    types_hash_max_size 2048;</span><br><span class=\"line\"></span><br><span class=\"line\">    include             /etc/nginx/mime.types;</span><br><span class=\"line\">    default_type        application/octet-stream;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tupstream backend &#123;</span><br><span class=\"line\">\t\tserver 127.0.0.1:8080;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    server &#123;</span><br><span class=\"line\">        listen 443;</span><br><span class=\"line\">        server_name loyom.com; #填写绑定证书的域名</span><br><span class=\"line\">        ssl on;</span><br><span class=\"line\">        ssl_certificate /opt/ca/1_loyom.com_bundle.crt;</span><br><span class=\"line\">        ssl_certificate_key /opt/ca/2_loyom.com.key;</span><br><span class=\"line\">        ssl_session_timeout 5m;</span><br><span class=\"line\">        ssl_protocols TLSv1.2;</span><br><span class=\"line\">        ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE;</span><br><span class=\"line\">        ssl_prefer_server_ciphers on;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\tlocation / &#123;</span><br><span class=\"line\">\t\t\tproxy_set_header Host $host;</span><br><span class=\"line\">\t\t\tproxy_set_header X-Real-IP $remote_addr;</span><br><span class=\"line\">\t\t\tproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\">\t\t   </span><br><span class=\"line\">\t\t\tproxy_buffering off;</span><br><span class=\"line\">\t\t\tproxy_pass http://backend;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tserver &#123;</span><br><span class=\"line\">        listen 80;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">        location / &#123;</span><br><span class=\"line\">\t\t\tproxy_set_header Host $host;</span><br><span class=\"line\">\t\t\tproxy_set_header X-Real-IP $remote_addr;</span><br><span class=\"line\">\t\t\tproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\">\t\t   </span><br><span class=\"line\">\t\t\tproxy_buffering off;</span><br><span class=\"line\">\t\t\tproxy_pass http://backend;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div></p>\n","text":"1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br","link":"","raw":null,"photos":[],"categories":[{"name":"Centos","slug":"Centos","count":30,"path":"api/categories/Centos.json"},{"name":"nginx","slug":"Centos/nginx","count":2,"path":"api/categories/Centos/nginx.json"},{"name":"ca","slug":"Centos/nginx/ca","count":1,"path":"api/categories/Centos/nginx/ca.json"}],"tags":[{"name":"Centos","slug":"Centos","count":29,"path":"api/tags/Centos.json"},{"name":"nginx","slug":"nginx","count":3,"path":"api/tags/nginx.json"},{"name":"ca","slug":"ca","count":1,"path":"api/tags/ca.json"},{"name":"openssl","slug":"openssl","count":1,"path":"api/tags/openssl.json"}]},{"title":"检测服务器是否连接着网络","slug":"检测服务器是否连接着网络","date":"2018-12-12T02:00:48.000Z","updated":"2018-12-12T02:00:48.336Z","comments":true,"path":"api/articles/检测服务器是否连接着网络.json","excerpt":"","keywords":null,"cover":null,"content":"<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 检测服务器是否连接着网络,如果网络不通 则 3次后 关机</span></span><br><span class=\"line\"><span class=\"comment\"># crontab -e</span></span><br><span class=\"line\"><span class=\"comment\"># */5 * * * * ./check.sh</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"Starting test network was clear...\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"built_in\">test</span> -e ./checkInfo</span><br><span class=\"line\">\t<span class=\"keyword\">then</span></span><br><span class=\"line\">\t<span class=\"built_in\">echo</span> <span class=\"string\">\"CheckInfo File Exist...\"</span></span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\">\tcat /dev/null &gt; ./checkInfo</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br><span class=\"line\"></span><br><span class=\"line\">last_res=`head -1 ./checkInfo`</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"title\">checkInternet</span></span>()&#123;</span><br><span class=\"line\">\tping_res=1</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> url <span class=\"keyword\">in</span> <span class=\"string\">\"8.8.8.8\"</span> <span class=\"string\">\"61.139.2.69\"</span> <span class=\"string\">\"114.114.114.114\"</span> <span class=\"string\">\"168.95.1.1\"</span> <span class=\"string\">\"223.5.5.5\"</span> <span class=\"string\">\"180.76.76.76\"</span></span><br><span class=\"line\">\t<span class=\"keyword\">do</span></span><br><span class=\"line\">\t\t<span class=\"built_in\">echo</span> <span class=\"string\">\"PING <span class=\"variable\">$&#123;url&#125;</span>\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t\tping=`ping -c 3 <span class=\"variable\">$&#123;url&#125;</span>|awk <span class=\"string\">'NR==7 &#123;print $4&#125;'</span>`</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> [ <span class=\"variable\">$&#123;ping&#125;</span> -eq 0 ]</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">then</span></span><br><span class=\"line\">\t\t\t\tping_res=1</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t\t\t\tping_res=2</span><br><span class=\"line\">\t\t<span class=\"keyword\">fi</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> [ <span class=\"variable\">$&#123;ping_res&#125;</span> -eq 2 ]</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">then</span></span><br><span class=\"line\">\t\t\t<span class=\"built_in\">break</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">fi</span></span><br><span class=\"line\">\t<span class=\"keyword\">done</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"built_in\">return</span> <span class=\"variable\">$&#123;ping_res&#125;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">checkInternet</span><br><span class=\"line\"></span><br><span class=\"line\">result=<span class=\"string\">\"$?\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> [ <span class=\"variable\">$&#123;result&#125;</span> -eq 1 ]</span><br><span class=\"line\">\t<span class=\"keyword\">then</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> [ <span class=\"string\">\"<span class=\"variable\">$&#123;last_res&#125;</span>\"</span> = <span class=\"string\">\"1\"</span> ]</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">then</span></span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">echo</span> <span class=\"string\">\"2\"</span> &gt; ./checkInfo</span><br><span class=\"line\">\t\t<span class=\"keyword\">elif</span> [ <span class=\"string\">\"<span class=\"variable\">$&#123;last_res&#125;</span>\"</span> = <span class=\"string\">\"2\"</span> ]</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">then</span></span><br><span class=\"line\">\t\t\t\tcat /dev/null &gt; ./checkInfo</span><br><span class=\"line\">\t\t\t\tinit 0</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">echo</span> <span class=\"string\">\"1\"</span> &gt; ./checkInfo</span><br><span class=\"line\">\t\t<span class=\"keyword\">fi</span></span><br><span class=\"line\">\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t\tcat /dev/null &gt; ./checkInfo</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br></pre></td></tr></table></figure></div>\n","text":"1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br","link":"","raw":null,"photos":[],"categories":[{"name":"Centos","slug":"Centos","count":30,"path":"api/categories/Centos.json"},{"name":"network","slug":"Centos/network","count":1,"path":"api/categories/Centos/network.json"}],"tags":[{"name":"Centos","slug":"Centos","count":29,"path":"api/tags/Centos.json"},{"name":"network","slug":"network","count":1,"path":"api/tags/network.json"},{"name":"shell","slug":"shell","count":1,"path":"api/tags/shell.json"}]},{"title":"Centos Linux 7 设置静态IP","slug":"Centos-Linux-7-设置静态IP","date":"2018-12-12T02:00:04.000Z","updated":"2018-12-12T02:00:04.606Z","comments":true,"path":"api/articles/Centos-Linux-7-设置静态IP.json","excerpt":"","keywords":null,"cover":null,"content":"<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">## 先进入配置文件的放置位置:</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> /etc/sysconfig/network-scripts/</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 查看当前网卡使用的是哪个文件</span></span><br><span class=\"line\">ip add</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 过滤出配置文件列表</span></span><br><span class=\"line\">ll | grep ifcfg</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 编辑配置文件 </span></span><br><span class=\"line\">vi ifcfg-ens160</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 配置文件内容 主要:BOOTPROTO   IPADDR   NETMASK   NM_CONTROLLED  ONBOOT 这几个字段,其他的不变</span></span><br><span class=\"line\">TYPE=Ethernet</span><br><span class=\"line\">BOOTPROTO=static</span><br><span class=\"line\">IPADDR=192.168.1.251</span><br><span class=\"line\">NETMASK=255.255.255.0</span><br><span class=\"line\">DNS1=8.8.8.8</span><br><span class=\"line\">DNS2=8.8.4.4</span><br><span class=\"line\">NM_CONTROLLED=no</span><br><span class=\"line\">DEFROUTE=yes</span><br><span class=\"line\">PEERDNS=yes</span><br><span class=\"line\">PEERROUTES=yes</span><br><span class=\"line\">IPV4_FAILURE_FATAL=no</span><br><span class=\"line\">IPV6INIT=yes</span><br><span class=\"line\">IPV6_AUTOCONF=yes</span><br><span class=\"line\">IPV6_DEFROUTE=yes</span><br><span class=\"line\">IPV6_PEERDNS=yes</span><br><span class=\"line\">IPV6_PEERROUTES=yes</span><br><span class=\"line\">IPV6_FAILURE_FATAL=no</span><br><span class=\"line\">IPV6_ADDR_GEN_MODE=stable-privacy</span><br><span class=\"line\">NAME=ens160</span><br><span class=\"line\">UUID=23a77b70-a6e3-4399-a5bd-4ca312a0f123</span><br><span class=\"line\">DEVICE=ens160</span><br><span class=\"line\">ONBOOT=yes</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 修改网关配置文件: </span></span><br><span class=\"line\">vi /etc/sysconfig/network</span><br><span class=\"line\"></span><br><span class=\"line\">NETWORKING=yes</span><br><span class=\"line\">NETWORKING_IPV6=no</span><br><span class=\"line\">HOSTNAME=localhost.localdomain</span><br><span class=\"line\">GATEWAY=192.168.1.1</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 重启网络服务</span></span><br><span class=\"line\">systemctl restart network.service</span><br></pre></td></tr></table></figure></div>\n","text":"1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br","link":"","raw":null,"photos":[],"categories":[{"name":"Centos","slug":"Centos","count":30,"path":"api/categories/Centos.json"},{"name":"ip","slug":"Centos/ip","count":1,"path":"api/categories/Centos/ip.json"}],"tags":[{"name":"Centos","slug":"Centos","count":29,"path":"api/tags/Centos.json"},{"name":"ip","slug":"ip","count":1,"path":"api/tags/ip.json"},{"name":"ifcfg","slug":"ifcfg","count":1,"path":"api/tags/ifcfg.json"}]},{"title":"关于Nginx的反向代理配置","slug":"关于Nginx的反向代理配置","date":"2018-12-12T01:59:26.000Z","updated":"2018-12-12T01:59:26.862Z","comments":true,"path":"api/articles/关于Nginx的反向代理配置.json","excerpt":"","keywords":null,"cover":null,"content":"<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"PLAIN\"><figure class=\"iseeu highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">worker_processes  4;</span><br><span class=\"line\"></span><br><span class=\"line\">error_log  /home/tools/nginx-1.8.1/logs/error.log;</span><br><span class=\"line\"></span><br><span class=\"line\">events &#123;</span><br><span class=\"line\">    worker_connections  512;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">http &#123;</span><br><span class=\"line\">    include       mime.types;</span><br><span class=\"line\">    default_type  application/octet-stream;</span><br><span class=\"line\">    sendfile        on;</span><br><span class=\"line\">    keepalive_timeout  65;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tupstream backend &#123;</span><br><span class=\"line\">\t\tserver 192.168.10.251;</span><br><span class=\"line\">\t\tserver 192.168.10.252;</span><br><span class=\"line\">\t\tserver 192.168.10.253;</span><br><span class=\"line\">\t\tserver 192.168.10.254;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    server &#123;</span><br><span class=\"line\">        listen       88;</span><br><span class=\"line\">        server_name  localhost;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">        location / &#123;</span><br><span class=\"line\">\t\t\tproxy_set_header Host $host;</span><br><span class=\"line\">\t\t\tproxy_set_header X-Real-IP $remote_addr;</span><br><span class=\"line\">\t\t\tproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\">\t\t   </span><br><span class=\"line\">\t\t\tproxy_buffering off;</span><br><span class=\"line\">\t\t\tproxy_pass http://backend;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">        error_page   500 502 503 504  /50x.html;</span><br><span class=\"line\">        location = /50x.html &#123;</span><br><span class=\"line\">            root   html;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div>\n","text":"1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br","link":"","raw":null,"photos":[],"categories":[{"name":"nginx","slug":"nginx","count":1,"path":"api/categories/nginx.json"}],"tags":[{"name":"nginx","slug":"nginx","count":3,"path":"api/tags/nginx.json"},{"name":"反向代理","slug":"反向代理","count":1,"path":"api/tags/反向代理.json"}]},{"title":"Centos常用操作记录","slug":"Centos常用操作记录","date":"2018-12-11T10:39:21.000Z","updated":"2018-12-11T10:39:21.309Z","comments":true,"path":"api/articles/Centos常用操作记录.json","excerpt":"","keywords":null,"cover":null,"content":"<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 重新设置nohup的输出文件</span></span><br><span class=\"line\">nohup <span class=\"built_in\">command</span> &gt; myout.file 2&gt;&amp;1 &amp;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 修改文件夹以及文件夹下的子文件权限</span></span><br><span class=\"line\">chmod 755 files/ -R</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 设置开机启动服务 ssh</span></span><br><span class=\"line\">systemctl <span class=\"built_in\">enable</span> sshd.service</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 禁用开机启动服务  firewalld</span></span><br><span class=\"line\">systemctl <span class=\"built_in\">disable</span> firewalld.service</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### Centos 解压 *.tar.xz 文件 </span></span><br><span class=\"line\">tar -xvJf *.tar.xz</span><br><span class=\"line\"><span class=\"comment\">### 如果这条命令出现错误:</span></span><br><span class=\"line\"><span class=\"comment\">### tar (child): xz: Cannot exec: No such file or directory</span></span><br><span class=\"line\"><span class=\"comment\">### tar (child): Error is not recoverable: exiting now</span></span><br><span class=\"line\"><span class=\"comment\">### 请安装:   yum install xz -y</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 查看ssh服务</span></span><br><span class=\"line\">systemctl list-unit-files | grep ssh</span><br><span class=\"line\"><span class=\"comment\">###启动SSH服务</span></span><br><span class=\"line\">systemctl start sshd.service</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 安装常用工具 如: iostat</span></span><br><span class=\"line\">yum install sysstat -y</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### Centos 解压 *.tar.gz 文件 </span></span><br><span class=\"line\">tar -xzvf *.tar.gz</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 解压 *.tar 文件</span></span><br><span class=\"line\">tar -xvf *.tar</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 解压 *.tar.bz2 文件</span></span><br><span class=\"line\">tar -xjvf *.tar.bz2</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 解压 *.tar.Z 文件</span></span><br><span class=\"line\">tar -xZvf *.tar.Z</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 查看连接数</span></span><br><span class=\"line\">netstat -nat |awk <span class=\"string\">'&#123;print $6&#125;'</span>|sort|uniq -c|sort -rn</span><br><span class=\"line\"></span><br><span class=\"line\">netstat -n | awk <span class=\"string\">'/^tcp/ &#123;++S[$NF]&#125; END &#123;for(a in S) print a, S[a]&#125;'</span></span><br><span class=\"line\"></span><br><span class=\"line\">netstat -ano | grep 80 | grep -v EST | less</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 查看80端口的连接数</span></span><br><span class=\"line\">netstat -nat|grep -i <span class=\"string\">\"80\"</span>|wc -l</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 安装常用的工具</span></span><br><span class=\"line\">yum install -y gcc gcc-c++ openssl-devel unixODBC-devel</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### ==单用户修改密码================================================</span></span><br><span class=\"line\"><span class=\"comment\">### Centos7 忘记密码 单用户修改</span></span><br><span class=\"line\"><span class=\"comment\">### 将ro改为rw init=/sysroot/bin/sh</span></span><br><span class=\"line\"><span class=\"comment\">### 进入chroot</span></span><br><span class=\"line\">chroot /sysroot</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 重置密码</span></span><br><span class=\"line\">passwd root</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 更新系统信息</span></span><br><span class=\"line\">touch /.autorelabel</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 退出chroot</span></span><br><span class=\"line\"><span class=\"built_in\">exit</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 重启</span></span><br><span class=\"line\">init 6</span><br><span class=\"line\"><span class=\"comment\">### ==单用户修改密码结束================================================</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">###Centos7 停用防火墙</span></span><br><span class=\"line\">systemctl stop firewalld.service</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 查看mongo程序的监听端口</span></span><br><span class=\"line\">netstat -tnlp | grep mongod</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 启动Memcached服务</span></span><br><span class=\"line\">./memcached -d -m 256 -u root -p 11211 -c 1024 –P /tmp/memcached.pid</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 后台启动Redis服务</span></span><br><span class=\"line\">./redis-server &amp;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 后台启动RabbitMQ服务</span></span><br><span class=\"line\">./rabbitmq-server start -detached</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 启动Solr服务</span></span><br><span class=\"line\">./solr start -p 8984</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 启动MongoDB服务</span></span><br><span class=\"line\">./mongod --maxConns=100 --port=27017 --bind_ip=127.0.0.1 --dbpath=/opt/mongodb/data/db --logpath=/opt/mongodb/data/<span class=\"built_in\">log</span>/mongodb.log --logappend --fork</span><br></pre></td></tr></table></figure></div>\n","text":"1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br","link":"","raw":null,"photos":[],"categories":[{"name":"Centos","slug":"Centos","count":30,"path":"api/categories/Centos.json"},{"name":"bash","slug":"Centos/bash","count":1,"path":"api/categories/Centos/bash.json"}],"tags":[{"name":"Centos","slug":"Centos","count":29,"path":"api/tags/Centos.json"},{"name":"bash","slug":"bash","count":1,"path":"api/tags/bash.json"}]},{"title":"Linux释放内存的命令","slug":"Linux释放内存的命令","date":"2018-12-11T10:38:49.000Z","updated":"2018-12-11T10:38:49.545Z","comments":true,"path":"api/articles/Linux释放内存的命令.json","excerpt":"","keywords":null,"cover":null,"content":"<p>Linux释放内存的命令：</p>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">##强制将内存中的文件缓冲内容写到磁盘</span></span><br><span class=\"line\">sync</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">##手动释放Linux中的所有缓存</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> 3 &gt; /proc/sys/vm/drop_caches</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">##释放完内存后改回去让系统重新自动分配内存</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> 0 &gt;/proc/sys/vm/drop_caches</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">##=================================</span></span><br><span class=\"line\">drop_caches值的含义：</span><br><span class=\"line\">0：不释放（系统默认值）</span><br><span class=\"line\">1：释放页缓存</span><br><span class=\"line\">2：释放dentries和inodes</span><br><span class=\"line\">3：释放所有缓存</span><br></pre></td></tr></table></figure></div>\n","text":"Linux释放内存的命令：1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>##强制将内存中的文件缓冲内容写到磁盘<br>sync<br><br>##手动释放Linux","link":"","raw":null,"photos":[],"categories":[{"name":"Centos","slug":"Centos","count":30,"path":"api/categories/Centos.json"},{"name":"sync","slug":"Centos/sync","count":1,"path":"api/categories/Centos/sync.json"}],"tags":[{"name":"Centos","slug":"Centos","count":29,"path":"api/tags/Centos.json"},{"name":"sync","slug":"sync","count":1,"path":"api/tags/sync.json"}]},{"title":"家庭电路 功率和负荷","slug":"家庭电路-功率和负荷","date":"2018-12-11T10:38:06.000Z","updated":"2018-12-11T10:38:06.618Z","comments":true,"path":"api/articles/家庭电路-功率和负荷.json","excerpt":"","keywords":null,"cover":null,"content":"<p>功率=电压*电流 </p>\n<p>铜心电线负荷=电压<em>系数安培</em>横切面积  （这个系数安培粗略点说应该在大约5–10安培之间，空气中为10左右，直接水泥坐死5左右，在线管中根据空间多少多在6–8之间）</p>\n<p>4平方的电线最大负荷是多少？4<em>220</em>6=5280  （保险起见，我们系数算低点）</p>\n<p>一般客厅大空调3000多瓦吧</p>\n","text":"功率=电压*电流 铜心电线负荷=电压系数安培横切面积  （这个系数安培粗略点说应该在大约5–10安培之间，空气中为10左右，直接水泥坐死5左右，在线管中根据空间多少多在6–8之间）4平方的电线最大负荷是多少？42206=5280  （保险起见，我们系数算低点）一般客厅大空调300","link":"","raw":null,"photos":[],"categories":[{"name":"功率","slug":"功率","count":1,"path":"api/categories/功率.json"},{"name":"负荷","slug":"功率/负荷","count":1,"path":"api/categories/功率/负荷.json"}],"tags":[{"name":"功率","slug":"功率","count":1,"path":"api/tags/功率.json"},{"name":"负荷","slug":"负荷","count":1,"path":"api/tags/负荷.json"}]},{"title":"C#读取XML文件","slug":"C-读取XML文件","date":"2018-12-11T10:37:26.000Z","updated":"2018-12-11T10:37:26.592Z","comments":true,"path":"api/articles/C-读取XML文件.json","excerpt":"","keywords":null,"cover":null,"content":"<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"CSHARP\"><figure class=\"iseeu highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">try</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    XmlDocument xmlDoc = <span class=\"keyword\">new</span> XmlDocument();</span><br><span class=\"line\">    xmlDoc.Load(<span class=\"string\">@\"types.xml\"</span>);</span><br><span class=\"line\">    XmlElement xmlRoot = xmlDoc.DocumentElement;</span><br><span class=\"line\">    <span class=\"keyword\">foreach</span> (XmlNode node <span class=\"keyword\">in</span> xmlRoot.ChildNodes)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        Type type = <span class=\"keyword\">new</span> Type();</span><br><span class=\"line\">        <span class=\"keyword\">string</span> num = node[<span class=\"string\">\"num\"</span>].InnerText;</span><br><span class=\"line\">        <span class=\"keyword\">string</span> desc = node[<span class=\"string\">\"desc\"</span>].InnerText;</span><br><span class=\"line\">        <span class=\"keyword\">string</span> content = node[<span class=\"string\">\"content\"</span>].InnerXml;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">catch</span> &#123; </span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div>\n","text":"1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>try<br>&#123;<br>    XmlDocument xmlDoc = new XmlDocu","link":"","raw":null,"photos":[],"categories":[{"name":"C#","slug":"C","count":2,"path":"api/categories/C.json"},{"name":"xml","slug":"C/xml","count":1,"path":"api/categories/C/xml.json"}],"tags":[{"name":"C#","slug":"C","count":2,"path":"api/tags/C.json"},{"name":"xml","slug":"xml","count":1,"path":"api/tags/xml.json"}]},{"title":"C#进行Socket 连接发送和接收数据","slug":"C-进行Socket-连接发送和接收数据","date":"2018-12-11T10:36:44.000Z","updated":"2018-12-11T10:37:33.561Z","comments":true,"path":"api/articles/C-进行Socket-连接发送和接收数据.json","excerpt":"","keywords":null,"cover":null,"content":"<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"CSHARP\"><figure class=\"iseeu highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span>  获取四位数的数字得到数据长度</span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"b\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">int</span> <span class=\"title\">byte2Int</span>(<span class=\"params\"><span class=\"keyword\">byte</span>[] b</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ((b[<span class=\"number\">0</span>] &amp; <span class=\"number\">0xff</span>) &lt;&lt; <span class=\"number\">24</span>) | ((b[<span class=\"number\">1</span>] &amp; <span class=\"number\">0xff</span>) &lt;&lt; <span class=\"number\">16</span>)</span><br><span class=\"line\">            | ((b[<span class=\"number\">2</span>] &amp; <span class=\"number\">0xff</span>) &lt;&lt; <span class=\"number\">8</span>) | (b[<span class=\"number\">3</span>] &amp; <span class=\"number\">0xff</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> 把数据长度转换为二进制</span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"a\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">byte</span>[] <span class=\"title\">int2Byte</span>(<span class=\"params\"><span class=\"keyword\">int</span> a</span>)</span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">byte</span>[] b = <span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[<span class=\"number\">4</span>];</span><br><span class=\"line\">    b[<span class=\"number\">0</span>] = (<span class=\"keyword\">byte</span>)(a &gt;&gt; <span class=\"number\">24</span>);</span><br><span class=\"line\">    b[<span class=\"number\">1</span>] = (<span class=\"keyword\">byte</span>)(a &gt;&gt; <span class=\"number\">16</span>);</span><br><span class=\"line\">    b[<span class=\"number\">2</span>] = (<span class=\"keyword\">byte</span>)(a &gt;&gt; <span class=\"number\">8</span>);</span><br><span class=\"line\">    b[<span class=\"number\">3</span>] = (<span class=\"keyword\">byte</span>)(a);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> b;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> 读取Socket的数据</span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"ip\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=\"port\"&gt;</span><span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\"><span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span><span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">readSocketData</span>(<span class=\"params\">String ip,<span class=\"keyword\">int</span> port,String requestData</span>)</span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">try</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        IPAddress ipAddress = IPAddress.Parse(ip);</span><br><span class=\"line\">        Socket clientSocket = <span class=\"keyword\">new</span> Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);</span><br><span class=\"line\">        clientSocket.ReceiveTimeout = <span class=\"number\">5000</span>;</span><br><span class=\"line\">        clientSocket.SendTimeout = <span class=\"number\">5000</span>;</span><br><span class=\"line\">        clientSocket.Connect(<span class=\"keyword\">new</span> IPEndPoint(ipAddress, port));</span><br><span class=\"line\"></span><br><span class=\"line\">        Task&lt;String&gt; readRes = Task.Factory.StartNew&lt;String&gt;(() =&gt;</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">byte</span>[] result = <span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[<span class=\"number\">40960</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">            clientSocket.Receive(result);</span><br><span class=\"line\">            <span class=\"keyword\">int</span> receiveLength = byte2Int(result);</span><br><span class=\"line\">            String response = Encoding.UTF8.GetString(result, headLength, receiveLength);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> response;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">byte</span>[] byteArray = System.Text.Encoding.UTF8.GetBytes(requestData);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> length = byteArray.Length;</span><br><span class=\"line\">        <span class=\"keyword\">byte</span>[] lenBytes = int2Byte(length);</span><br><span class=\"line\">        <span class=\"keyword\">byte</span>[] newBytes = <span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[lenBytes.Length + length];</span><br><span class=\"line\">        lenBytes.CopyTo(newBytes, <span class=\"number\">0</span>);</span><br><span class=\"line\">        byteArray.CopyTo(newBytes, lenBytes.Length);</span><br><span class=\"line\">        clientSocket.Send(newBytes);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">string</span> resultStr = readRes.Result;</span><br><span class=\"line\">        MessageBox.Show(resultStr, <span class=\"string\">\"Socket Result\"</span>, MessageBoxButtons.OK, MessageBoxIcon.Error);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">catch</span> (Exception ex)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        MessageBox.Show(<span class=\"string\">\"Socket connect fail.\\r\\n\"</span> + ex.Message, <span class=\"string\">\"ERROR\"</span>, MessageBoxButtons.OK, MessageBoxIcon.Error);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">finally</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.btn_submit.Enabled = <span class=\"literal\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div>","text":"1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br","link":"","raw":null,"photos":[],"categories":[{"name":"C#","slug":"C","count":2,"path":"api/categories/C.json"},{"name":"socket","slug":"C/socket","count":1,"path":"api/categories/C/socket.json"}],"tags":[{"name":"C#","slug":"C","count":2,"path":"api/tags/C.json"},{"name":"socket","slug":"socket","count":1,"path":"api/tags/socket.json"}]}]}