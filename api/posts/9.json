{"total":94,"pageSize":10,"pageCount":10,"data":[{"title":"如何理解RESTful的幂等性","slug":"如何理解RESTful的幂等性","date":"2018-12-11T09:18:42.000Z","updated":"2018-12-11T09:21:11.231Z","comments":true,"path":"api/articles/如何理解RESTful的幂等性.json","excerpt":"","keywords":null,"cover":null,"content":"<h1 id=\"如何理解RESTful的幂等性\"><a href=\"#如何理解RESTful的幂等性\" class=\"headerlink\" title=\"如何理解RESTful的幂等性\"></a>如何理解RESTful的幂等性</h1><h3 id=\"怎么理解幂等性\"><a href=\"#怎么理解幂等性\" class=\"headerlink\" title=\"怎么理解幂等性\"></a>怎么理解幂等性</h3><p>HTTP幂等方法，是指无论调用多少次都不会有不同结果的 HTTP 方法。不管你调用一次，还是调用一百次，一千次，结果都是相同的。<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"CMD\"><figure class=\"iseeu highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET     /tickets       # 获取ticket列表</span><br><span class=\"line\">GET     /tickets/<span class=\"number\">12</span>    # 查看某个具体的ticket</span><br><span class=\"line\">POST    /tickets       # 新建一个ticket</span><br><span class=\"line\">PUT     /tickets/<span class=\"number\">12</span>    # 更新ticket <span class=\"number\">12</span></span><br><span class=\"line\">PATCH   /tickets/<span class=\"number\">12</span>    # 更新ticket <span class=\"number\">12</span></span><br><span class=\"line\">DELETE  /tickets/<span class=\"number\">12</span>    # 删除ticekt <span class=\"number\">12</span></span><br></pre></td></tr></table></figure></div></p>\n<h3 id=\"HTTP-GET方法\"><a href=\"#HTTP-GET方法\" class=\"headerlink\" title=\"HTTP GET方法\"></a>HTTP GET方法</h3><p>HTTP GET方法，用于获取资源，不管调用多少次接口，结果都不会改变，所以是幂等的。<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"CMD\"><figure class=\"iseeu highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET     /tickets       # 获取ticket列表</span><br><span class=\"line\">GET     /tickets/<span class=\"number\">12</span>    # 查看某个具体的ticket</span><br></pre></td></tr></table></figure></div></p>\n<p>只是查询数据，不会影响到资源的变化，因此我们认为它幂等。</p>\n<p>值得注意，幂等性指的是作用于结果而非资源本身。怎么理解呢？</p>\n<p>例如，这个HTTP GET方法可能会每次得到不同的返回内容，但并不影响资源。</p>\n<p>可能你会问有这种情况么？当然有咯。例如，我们有一个接口获取当前时间，我们就应该设计成<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"CMD\"><figure class=\"iseeu highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET     /service_time # 获取服务器当前时间</span><br></pre></td></tr></table></figure></div></p>\n<p>它本身不会对资源本身产生影响，因此满足幂等性。</p>\n<h3 id=\"HTTP-POST方法\"><a href=\"#HTTP-POST方法\" class=\"headerlink\" title=\"HTTP POST方法\"></a>HTTP POST方法</h3><p>HTTP POST方法是一个非幂等方法，因为调用多次，都将产生新的资源。<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"CMD\"><figure class=\"iseeu highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST    /tickets       # 新建一个ticket</span><br></pre></td></tr></table></figure></div></p>\n<p>因为它会对资源本身产生影响，每次调用都会有新的资源产生，因此不满足幂等性。</p>\n<h3 id=\"HTTP-PUT方法\"><a href=\"#HTTP-PUT方法\" class=\"headerlink\" title=\"HTTP PUT方法\"></a>HTTP PUT方法</h3><p>HTTP PUT方法是不是幂等的呢？我们来看下<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"CMD\"><figure class=\"iseeu highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PUT     /tickets/<span class=\"number\">12</span>    # 更新ticket <span class=\"number\">12</span></span><br></pre></td></tr></table></figure></div></p>\n<p>因为它直接把实体部分的数据替换到服务器的资源，我们多次调用它，只会产生一次影响，但是有相同结果的 HTTP 方法，所以满足幂等性。</p>\n<h3 id=\"HTTP-PATCH方法\"><a href=\"#HTTP-PATCH方法\" class=\"headerlink\" title=\"HTTP PATCH方法\"></a>HTTP PATCH方法</h3><p>HTTP PATCH方法是非幂等的。HTTP POST方法和HTTP PUT方法可能比较好理解，但是HTTP PATCH方法只是更新部分资源，怎么是非幂等的呢?</p>\n<p>因为，PATCH提供的实体则需要根据程序或其它协议的定义，解析后在服务器上执行，以此来修改服务器上的资源。换句话说，PATCH请求是会执行某个程序的，如果重复提交，程序可能执行多次，对服务器上的资源就可能造成额外的影响，这就可以解释它为什么是非幂等的了。</p>\n<p>可能你还不能理解这点。我们举个例子<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"CMD\"><figure class=\"iseeu highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">PATCH   /tickets/<span class=\"number\">12</span>    # 更新ticket <span class=\"number\">12</span></span><br></pre></td></tr></table></figure></div></p>\n<p>此时，我们服务端对方法的处理是，当调用一次方法，更新部分字段，将这条ticket记录的操作记录加一，这次，每次调用的资源是不是变了呢，所以它是有可能是非幂等的操作。</p>\n<h3 id=\"HTTP-DELETE方法\"><a href=\"#HTTP-DELETE方法\" class=\"headerlink\" title=\"HTTP DELETE方法\"></a>HTTP DELETE方法</h3><p>HTTP DELETE方法用于删除资源，会将资源删除。<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"CMD\"><figure class=\"iseeu highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">DELETE  /tickets/<span class=\"number\">12</span>    # 删除ticekt <span class=\"number\">12</span></span><br></pre></td></tr></table></figure></div></p>\n<p>调用一次和多次对资源产生影响是相同的，所以也满足幂等性。</p>\n<h2 id=\"如何设计符合幂等性的高质量RESTful-API\"><a href=\"#如何设计符合幂等性的高质量RESTful-API\" class=\"headerlink\" title=\"如何设计符合幂等性的高质量RESTful API\"></a>如何设计符合幂等性的高质量RESTful API</h2><h3 id=\"HTTP-GET方法-vs-HTTP-POST方法\"><a href=\"#HTTP-GET方法-vs-HTTP-POST方法\" class=\"headerlink\" title=\"HTTP GET方法 vs HTTP POST方法\"></a>HTTP GET方法 vs HTTP POST方法</h3><p>也许，你会想起一个面试题。HTTP请求的GET与POST方式有什么区别？你可能会回答到：GET方式通过URL提交数据，数据在URL中可以看到；POST方式，数据放置在HTML HEADER内提交。但是，我们现在从RESTful的资源角度来看待问题，HTTP GET方法是幂等的，所以它适合作为查询操作，HTTP POST方法是非幂等的，所以用来表示新增操作。</p>\n<p>但是，也有例外，我们有的时候可能需要把查询方法改造成HTTP POST方法。比如，超长（1k）的GET URL使用POST方法来替代，因为GET受到URL长度的限制。虽然，它不符合幂等性，但是它是一种折中的方案。</p>\n<h3 id=\"HTTP-POST方法-vs-HTTP-PUT方法\"><a href=\"#HTTP-POST方法-vs-HTTP-PUT方法\" class=\"headerlink\" title=\"HTTP POST方法 vs HTTP PUT方法\"></a>HTTP POST方法 vs HTTP PUT方法</h3><p>对于HTTP POST方法和TTP PUT方法，我们一般的理解是POST表示创建资源，PUT表示更新资源。当然，这个是正确的理解。</p>\n<p>但是，实际上，两个方法都用于创建资源，更为本质的差别是在幂等性。HTTP POST方法是非幂等，所以用来表示创建资源，HTTP PUT方法是幂等的，因此表示更新资源更加贴切。</p>\n<h3 id=\"HTTP-PUT方法-vs-HTTP-PATCH方法\"><a href=\"#HTTP-PUT方法-vs-HTTP-PATCH方法\" class=\"headerlink\" title=\"HTTP PUT方法 vs HTTP PATCH方法\"></a>HTTP PUT方法 vs HTTP PATCH方法</h3><p>此时，你看会有另外一个问题。HTTP PUT方法和HTTP PATCH方法，都是用来表述更新资源，它们之间有什么区别呢？我们一般的理解是PUT表示更新全部资源，PATCH表示更新部分资源。首先，这个是我们遵守的第一准则。根据上面的描述，PATCH方法是非幂等的，因此我们在设计我们服务端的RESTful API的时候，也需要考虑。如果，我们想要明确的告诉调用者我们的资源是幂等的，我的设计更倾向于使用HTTP PUT方法。</p>\n<p>原文链接:<a href=\"http://blog.720ui.com/2016/restful_idempotent/\" target=\"_blank\" rel=\"noopener\">http://blog.720ui.com/2016/restful_idempotent/</a></p>\n","text":"如何理解RESTful的幂等性怎么理解幂等性HTTP幂等方法，是指无论调用多少次都不会有不同结果的 HTTP 方法。不管你调用一次，还是调用一百次，一千次，结果都是相同的。<br>1<br>2<br>3<br>4<br>5<br>6<br>GET     /tickets    ","link":"","raw":null,"photos":[],"categories":[{"name":"幂等性","slug":"幂等性","count":1,"path":"api/categories/幂等性.json"},{"name":"restful","slug":"幂等性/restful","count":1,"path":"api/categories/幂等性/restful.json"}],"tags":[{"name":"restful","slug":"restful","count":1,"path":"api/tags/restful.json"},{"name":"幂等性","slug":"幂等性","count":1,"path":"api/tags/幂等性.json"}]},{"title":"Springboot无法访问static的html","slug":"Springboot无法访问static的html","date":"2018-12-11T09:18:08.000Z","updated":"2018-12-11T09:18:08.142Z","comments":true,"path":"api/articles/Springboot无法访问static的html.json","excerpt":"","keywords":null,"cover":null,"content":"<h1 id=\"Springboot无法访问static的html\"><a href=\"#Springboot无法访问static的html\" class=\"headerlink\" title=\"Springboot无法访问static的html\"></a>Springboot无法访问static的html</h1><p>在项目中如果使用了</p>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"JAVA\"><figure class=\"iseeu highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@EnableWebMvc</span></span><br></pre></td></tr></table></figure></div>\n<p>那么就会自动覆盖了官方给出的</p>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"CMD\"><figure class=\"iseeu highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/static, /public, META-INF/resources, /resources</span><br></pre></td></tr></table></figure></div>\n<p>存放静态资源的目录。而将静态资源定位于</p>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"CMD\"><figure class=\"iseeu highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">src/main/webapp</span><br></pre></td></tr></table></figure></div>\n<p>所以当要访问 /static 里面内容的时候不要使用此注解</p>\n","text":"Springboot无法访问static的html在项目中如果使用了1<br>@EnableWebMvc<br>那么就会自动覆盖了官方给出的1<br>/static, /public, META-INF/resources, /resources<br>存放静态资源的目录。而将静","link":"","raw":null,"photos":[],"categories":[{"name":"java","slug":"java","count":21,"path":"api/categories/java.json"},{"name":"spring","slug":"java/spring","count":1,"path":"api/categories/java/spring.json"},{"name":"resources","slug":"java/spring/resources","count":1,"path":"api/categories/java/spring/resources.json"}],"tags":[{"name":"java","slug":"java","count":25,"path":"api/tags/java.json"},{"name":"Spring","slug":"Spring","count":1,"path":"api/tags/Spring.json"},{"name":"html","slug":"html","count":1,"path":"api/tags/html.json"},{"name":"resources","slug":"resources","count":1,"path":"api/tags/resources.json"},{"name":"webaoo","slug":"webaoo","count":1,"path":"api/tags/webaoo.json"}]},{"title":"在Java代码中使用Spring WebSocket","slug":"在Java代码中使用Spring-WebSocket","date":"2018-12-11T09:13:27.000Z","updated":"2018-12-11T09:15:51.349Z","comments":true,"path":"api/articles/在Java代码中使用Spring-WebSocket.json","excerpt":"","keywords":null,"cover":null,"content":"<h1 id=\"在Java代码中使用Spring-WebSocket\"><a href=\"#在Java代码中使用Spring-WebSocket\" class=\"headerlink\" title=\"在Java代码中使用Spring WebSocket\"></a>在Java代码中使用Spring WebSocket</h1><p>首先 pom.xml<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"XML\"><figure class=\"iseeu highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.5.8.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.commons<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>commons-io<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>javax.websocket<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>javax.websocket-api<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.0<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>provided<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-websocket<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">exclusions</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">exclusion</span>&gt;</span></span><br><span class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">\t\t\t<span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;/<span class=\"name\">exclusion</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">exclusions</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-undertow<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></div></p>\n<p>接收消息后的处理类 GameHandler :<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"JAVA\"><figure class=\"iseeu highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.net.URI;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.BinaryMessage;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.CloseStatus;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.PongMessage;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.TextMessage;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.WebSocketSession;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.handler.AbstractWebSocketHandler;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">GameHandler</span> <span class=\"keyword\">extends</span> <span class=\"title\">AbstractWebSocketHandler</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 处理字符串类的信息</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> session</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> message</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">handleTextMessage</span><span class=\"params\">(WebSocketSession session, TextMessage message)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        session.sendMessage(<span class=\"keyword\">new</span> TextMessage(message.asBytes()));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 处理二进制类的信息</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> session</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> message</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">handleBinaryMessage</span><span class=\"params\">(WebSocketSession session, BinaryMessage message)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        session.sendMessage(<span class=\"keyword\">new</span> BinaryMessage(message.getPayload()));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * ping-pong</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> session</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> message</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">handlePongMessage</span><span class=\"params\">(WebSocketSession session, PongMessage message)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 传出错误的处理</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> session</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> exception</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">handleTransportError</span><span class=\"params\">(WebSocketSession session, Throwable exception)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 连接关闭的处理</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> session</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> status</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">afterConnectionClosed</span><span class=\"params\">(WebSocketSession session, CloseStatus status)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 连接建立后的处理</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> session</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@throws</span> Exception</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">afterConnectionEstablished</span><span class=\"params\">(WebSocketSession session)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div></p>\n<p>握手信息拦截器  WebSocketHandshakeInterceptor :</p>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"JAVA\"><figure class=\"iseeu highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.Map;</span><br><span class=\"line\"><span class=\"keyword\">import</span> javax.servlet.http.Cookie;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.http.server.ServerHttpRequest;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.http.server.ServerHttpResponse;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.http.server.ServletServerHttpRequest;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.WebSocketHandler;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.server.HandshakeInterceptor;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">WebSocketHandshakeInterceptor</span> <span class=\"keyword\">implements</span> <span class=\"title\">HandshakeInterceptor</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">beforeHandshake</span><span class=\"params\">(ServerHttpRequest request, ServerHttpResponse shr1, WebSocketHandler wsh, Map&lt;String, Object&gt; attributes)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 此处可以做一些权限认证的事情或者其他</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">afterHandshake</span><span class=\"params\">(ServerHttpRequest shr, ServerHttpResponse shr1, WebSocketHandler wsh, Exception excptn)</span> </span>&#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div>\n<p>使用WebSocket的配置类  WebSocketConfig :</p>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"JAVA\"><figure class=\"iseeu highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Bean;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Configuration;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.config.annotation.EnableWebSocket;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.config.annotation.WebSocketConfigurer;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.socket.config.annotation.WebSocketHandlerRegistry;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"meta\">@EnableWebSocket</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">WebSocketConfig</span> <span class=\"keyword\">extends</span> <span class=\"title\">WebMvcConfigurerAdapter</span> <span class=\"keyword\">implements</span> <span class=\"title\">WebSocketConfigurer</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">registerWebSocketHandlers</span><span class=\"params\">(WebSocketHandlerRegistry registry)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 允许连接的域,只能以http或https开头</span></span><br><span class=\"line\">        String[] allowsOrigins = &#123;<span class=\"string\">\"http://127.0.0.1:1213\"</span>, <span class=\"string\">\"http://localhost:1213\"</span>&#125;;</span><br><span class=\"line\">        registry.addHandler(gameHandler(),<span class=\"string\">\"/game\"</span>).addInterceptors(handshakeInterceptor()).setAllowedOrigins(allowsOrigins);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> GameHandler <span class=\"title\">gameHandler</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> GameHandler();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> WebSocketHandshakeInterceptor <span class=\"title\">handshakeInterceptor</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> WebSocketHandshakeInterceptor();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div>\n<p>启动类 Launcher  : </p>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"JAVA\"><figure class=\"iseeu highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Launcher</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] params)</span> </span>&#123;</span><br><span class=\"line\">        SpringApplication.run(Launcher.class, params);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div>\n<p>配置文件 main/resources/application.properties:<br><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server.port=1213</span><br><span class=\"line\">server.session-timeout=1800</span><br><span class=\"line\">server.undertow.io-threads=4</span><br><span class=\"line\">server.undertow.worker-threads=20</span><br><span class=\"line\">server.undertow.buffer-size=1024</span><br><span class=\"line\">server.undertow.buffers-per-region=1024</span><br><span class=\"line\">server.undertow.direct-buffers=true</span><br></pre></td></tr></table></figure></p>\n<p>前端的测试页面 main\\resources\\static\\index.html</p>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"HTML\"><figure class=\"iseeu highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE html&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">\"zh-CN\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"utf-8\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">http-equiv</span>=<span class=\"string\">\"X-UA-Compatible\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"IE=edge\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">name</span>=<span class=\"string\">\"viewport\"</span> <span class=\"attr\">content</span>=<span class=\"string\">\"width=device-width, initial-scale=1\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Platform Gateway<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">link</span> <span class=\"attr\">href</span>=<span class=\"string\">\"https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css\"</span> <span class=\"attr\">rel</span>=<span class=\"string\">\"stylesheet\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--&lt;link href=\"https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap-theme.min.css\" rel=\"stylesheet\"&gt;--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://cdn.bootcss.com/jquery-scrollTo/2.1.2/jquery.scrollTo.min.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://cdnjs.cloudflare.com/ajax/libs/pako/1.0.6/pako.min.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--[if lt IE 9]&gt;</span></span><br><span class=\"line\"><span class=\"comment\">          &lt;script src=\"https://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js\"&gt;&lt;/script&gt;</span></span><br><span class=\"line\"><span class=\"comment\">          &lt;script src=\"https://cdn.bootcss.com/respond.js/1.4.2/respond.min.js\"&gt;&lt;/script&gt;</span></span><br><span class=\"line\"><span class=\"comment\">        &lt;![endif]--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">style</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"undefined\">            #message&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                height: 600px;</span></span><br><span class=\"line\"><span class=\"undefined\">                overflow-y:auto;</span></span><br><span class=\"line\"><span class=\"undefined\">            &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">        </span><span class=\"tag\">&lt;/<span class=\"name\">style</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"container\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>WebSocket Test Page<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">hr</span>/&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"form-inline\"</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"form-group\"</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">label</span> <span class=\"attr\">for</span>=<span class=\"string\">\"wsAddr\"</span>&gt;</span>WebSocket Address: <span class=\"tag\">&lt;/<span class=\"name\">label</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"input-group\"</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"input-group-addon\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"basic-ws\"</span>&gt;</span>ws://127.0.0.1:1213/<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"form-control\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"basic-ws-addr\"</span> <span class=\"attr\">aria-describedby</span>=<span class=\"string\">\"basic-ws\"</span> <span class=\"attr\">placeholder</span>=<span class=\"string\">\"game\"</span> <span class=\"attr\">data-container</span>=<span class=\"string\">\"body\"</span>  <span class=\"attr\">data-placement</span>=<span class=\"string\">\"top\"</span> <span class=\"attr\">data-content</span>=<span class=\"string\">\"链接地址不能为空,请填写\"</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"btnConnect\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"btn btn-primary\"</span> <span class=\"attr\">onclick</span>=<span class=\"string\">\"connect();\"</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"glyphicon glyphicon-resize-small\"</span> <span class=\"attr\">aria-hidden</span>=<span class=\"string\">\"true\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">                    连接</span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"btnClose\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"btn btn-danger\"</span> <span class=\"attr\">disabled</span>=<span class=\"string\">\"disabled\"</span> <span class=\"attr\">onclick</span>=<span class=\"string\">\"closeWebSocket();\"</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"glyphicon glyphicon-remove\"</span> <span class=\"attr\">aria-hidden</span>=<span class=\"string\">\"true\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">                    断开</span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">button</span> <span class=\"attr\">type</span>=<span class=\"string\">\"button\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"btnSend\"</span> <span class=\"attr\">class</span>=<span class=\"string\">\"btn btn-info\"</span> <span class=\"attr\">disabled</span>=<span class=\"string\">\"disabled\"</span> <span class=\"attr\">style</span>=<span class=\"string\">\"margin-left: 50px;\"</span> <span class=\"attr\">onclick</span>=<span class=\"string\">\"send();\"</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">span</span> <span class=\"attr\">class</span>=<span class=\"string\">\"glyphicon glyphicon-transfer\"</span> <span class=\"attr\">aria-hidden</span>=<span class=\"string\">\"true\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span><br><span class=\"line\">                    发送消息</span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">button</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span>/&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">textarea</span> <span class=\"attr\">class</span>=<span class=\"string\">\"form-control\"</span> <span class=\"attr\">id</span>=<span class=\"string\">\"inMsg\"</span> <span class=\"attr\">rows</span>=<span class=\"string\">\"5\"</span> <span class=\"attr\">placeholder</span>=<span class=\"string\">\"在这里输入需要发送的信息...\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">textarea</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">hr</span>/&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"message\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">                    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">zip</span>(<span class=\"params\">str</span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">                        <span class=\"keyword\">var</span> binaryString = pako.gzip(str, &#123;<span class=\"attr\">to</span>: <span class=\"string\">'string'</span>&#125;);</span></span><br><span class=\"line\"><span class=\"javascript\">                        <span class=\"keyword\">return</span> btoa(binaryString);</span></span><br><span class=\"line\"><span class=\"undefined\">                    &#125;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">                    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">unzip</span>(<span class=\"params\">b64Data</span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">                        <span class=\"keyword\">var</span> strData = atob(b64Data);</span></span><br><span class=\"line\"><span class=\"javascript\">                        <span class=\"keyword\">var</span> charData = strData.split(<span class=\"string\">''</span>).map(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">x</span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">                            <span class=\"keyword\">return</span> x.charCodeAt(<span class=\"number\">0</span>);</span></span><br><span class=\"line\"><span class=\"undefined\">                        &#125;);</span></span><br><span class=\"line\"><span class=\"javascript\">                        <span class=\"keyword\">var</span> binData = <span class=\"keyword\">new</span> <span class=\"built_in\">Uint8Array</span>(charData);</span></span><br><span class=\"line\"><span class=\"javascript\">                        <span class=\"keyword\">var</span> data = pako.inflate(binData);</span></span><br><span class=\"line\"><span class=\"javascript\">                        strData = <span class=\"built_in\">String</span>.fromCharCode.apply(<span class=\"literal\">null</span>, <span class=\"keyword\">new</span> <span class=\"built_in\">Uint16Array</span>(data));</span></span><br><span class=\"line\"><span class=\"javascript\">                        <span class=\"keyword\">return</span> strData;</span></span><br><span class=\"line\"><span class=\"undefined\">                    &#125;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">                    <span class=\"keyword\">var</span> websocket = <span class=\"literal\">null</span>;</span></span><br><span class=\"line\"><span class=\"javascript\">                    <span class=\"keyword\">var</span> wsBaseUrl = <span class=\"literal\">null</span>;</span></span><br><span class=\"line\"><span class=\"javascript\">                    <span class=\"keyword\">var</span> wsUrl = <span class=\"literal\">null</span>;</span></span><br><span class=\"line\"><span class=\"javascript\">                    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">init</span>(<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">                        wsBaseUrl = <span class=\"string\">\"ws://\"</span> + <span class=\"built_in\">window</span>.location.host + <span class=\"string\">\"/\"</span>;</span></span><br><span class=\"line\"><span class=\"javascript\">                        $(<span class=\"string\">\"#basic-ws\"</span>).text(wsBaseUrl);</span></span><br><span class=\"line\"><span class=\"javascript\">                        $(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">                            $(<span class=\"string\">'[data-toggle=\"popover\"]'</span>).popover();</span></span><br><span class=\"line\"><span class=\"undefined\">                        &#125;);</span></span><br><span class=\"line\"><span class=\"javascript\">                        <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">                    &#125;</span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"comment\">//关闭WebSocket连接</span></span></span><br><span class=\"line\"><span class=\"javascript\">                    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">closeWebSocket</span>(<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">                        <span class=\"keyword\">if</span> (websocket) &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                            websocket.close();</span></span><br><span class=\"line\"><span class=\"undefined\">                        &#125;</span></span><br><span class=\"line\"><span class=\"javascript\">                        <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">                    &#125;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"comment\">//将消息显示在网页上</span></span></span><br><span class=\"line\"><span class=\"javascript\">                    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">setMessageInnerHTML</span>(<span class=\"params\">who, msg</span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">                        <span class=\"keyword\">var</span> message = <span class=\"literal\">null</span>;</span></span><br><span class=\"line\"><span class=\"javascript\">                        <span class=\"keyword\">if</span> (who === <span class=\"number\">1</span>) &#123;</span></span><br><span class=\"line\"><span class=\"xml\">                            message = '<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"alert alert-success\"</span> <span class=\"attr\">role</span>=<span class=\"string\">\"alert\"</span>&gt;</span>本地: ' + msg + '<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span>';</span></span><br><span class=\"line\"><span class=\"javascript\">                        &#125; <span class=\"keyword\">else</span> &#123;</span></span><br><span class=\"line\"><span class=\"xml\">                            message = '<span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">class</span>=<span class=\"string\">\"alert alert-info\"</span> <span class=\"attr\">role</span>=<span class=\"string\">\"alert\"</span>&gt;</span>服务器: ' + msg + '<span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span>';</span></span><br><span class=\"line\"><span class=\"undefined\">                        &#125;</span></span><br><span class=\"line\"><span class=\"javascript\">                        <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'message'</span>).innerHTML = (<span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'message'</span>).innerHTML + message);</span></span><br><span class=\"line\"><span class=\"javascript\">                        $(<span class=\"string\">\"#message\"</span>).scrollTo(<span class=\"string\">'100%'</span>);</span></span><br><span class=\"line\"><span class=\"javascript\">                        <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">                    &#125;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"comment\">//发送消息</span></span></span><br><span class=\"line\"><span class=\"javascript\">                    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">send</span>(<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">                        <span class=\"keyword\">if</span> (websocket) &#123;</span></span><br><span class=\"line\"><span class=\"javascript\">                            <span class=\"keyword\">var</span> message = $(<span class=\"string\">\"#inMsg\"</span>).val();</span></span><br><span class=\"line\"><span class=\"undefined\">                            websocket.send(zip(message));</span></span><br><span class=\"line\"><span class=\"undefined\">                            setMessageInnerHTML(1, message);</span></span><br><span class=\"line\"><span class=\"undefined\">                        &#125;</span></span><br><span class=\"line\"><span class=\"javascript\">                        <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">                    &#125;</span></span><br><span class=\"line\"><span class=\"javascript\">                    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">connect</span>(<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">                        <span class=\"keyword\">var</span> url = $(<span class=\"string\">\"#basic-ws-addr\"</span>).val();</span></span><br><span class=\"line\"><span class=\"javascript\">                        <span class=\"keyword\">if</span> (url.length &lt;= <span class=\"number\">0</span>) &#123;</span></span><br><span class=\"line\"><span class=\"javascript\">                            $(<span class=\"string\">'#basic-ws-addr'</span>).popover(<span class=\"string\">'show'</span>);</span></span><br><span class=\"line\"><span class=\"javascript\">                            setTimeout(<span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">                                $(<span class=\"string\">'#basic-ws-addr'</span>).popover(<span class=\"string\">'hide'</span>);</span></span><br><span class=\"line\"><span class=\"undefined\">                            &#125;, 3000);</span></span><br><span class=\"line\"><span class=\"javascript\">                        &#125; <span class=\"keyword\">else</span> &#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                            wsUrl = wsBaseUrl + url;</span></span><br><span class=\"line\"><span class=\"javascript\">                            <span class=\"keyword\">if</span> (<span class=\"string\">'WebSocket'</span> <span class=\"keyword\">in</span> <span class=\"built_in\">window</span>) &#123;</span></span><br><span class=\"line\"><span class=\"javascript\">                                websocket = <span class=\"keyword\">new</span> WebSocket(wsUrl);</span></span><br><span class=\"line\"><span class=\"javascript\">                                <span class=\"comment\">//连接发生错误的回调方法</span></span></span><br><span class=\"line\"><span class=\"javascript\">                                websocket.onerror = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">                                    setMessageInnerHTML(<span class=\"number\">0</span>, <span class=\"string\">\"WebSocket连接发生错误 -&gt; \"</span> + wsUrl);</span></span><br><span class=\"line\"><span class=\"javascript\">                                    $(<span class=\"string\">\"#btnConnect\"</span>).removeAttr(<span class=\"string\">\"disabled\"</span>);</span></span><br><span class=\"line\"><span class=\"javascript\">                                    $(<span class=\"string\">\"#btnClose\"</span>).attr(<span class=\"string\">\"disabled\"</span>, <span class=\"string\">\"disabled\"</span>);</span></span><br><span class=\"line\"><span class=\"javascript\">                                    $(<span class=\"string\">\"#btnSend\"</span>).attr(<span class=\"string\">\"disabled\"</span>, <span class=\"string\">\"disabled\"</span>);</span></span><br><span class=\"line\"><span class=\"undefined\">                                &#125;;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">                                <span class=\"comment\">//连接成功建立的回调方法</span></span></span><br><span class=\"line\"><span class=\"javascript\">                                websocket.onopen = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">                                    setMessageInnerHTML(<span class=\"number\">0</span>, <span class=\"string\">\"WebSocket连接成功 -&gt; \"</span> + wsUrl);</span></span><br><span class=\"line\"><span class=\"javascript\">                                    $(<span class=\"string\">\"#btnConnect\"</span>).attr(<span class=\"string\">\"disabled\"</span>, <span class=\"string\">\"disabled\"</span>);</span></span><br><span class=\"line\"><span class=\"javascript\">                                    $(<span class=\"string\">\"#btnClose\"</span>).removeAttr(<span class=\"string\">\"disabled\"</span>);</span></span><br><span class=\"line\"><span class=\"javascript\">                                    $(<span class=\"string\">\"#btnSend\"</span>).removeAttr(<span class=\"string\">\"disabled\"</span>);</span></span><br><span class=\"line\"><span class=\"undefined\">                                &#125;;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">                                <span class=\"comment\">//接收到消息的回调方法</span></span></span><br><span class=\"line\"><span class=\"javascript\">                                websocket.onmessage = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">event</span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                                    setMessageInnerHTML(0, unzip(event.data));</span></span><br><span class=\"line\"><span class=\"undefined\">                                &#125;;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">                                <span class=\"comment\">//连接关闭的回调方法</span></span></span><br><span class=\"line\"><span class=\"javascript\">                                websocket.onclose = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">                                    setMessageInnerHTML(<span class=\"number\">0</span>, <span class=\"string\">\"WebSocket连接关闭 -&gt; \"</span> + wsUrl);</span></span><br><span class=\"line\"><span class=\"javascript\">                                    $(<span class=\"string\">\"#btnConnect\"</span>).removeAttr(<span class=\"string\">\"disabled\"</span>);</span></span><br><span class=\"line\"><span class=\"javascript\">                                    $(<span class=\"string\">\"#btnClose\"</span>).attr(<span class=\"string\">\"disabled\"</span>, <span class=\"string\">\"disabled\"</span>);</span></span><br><span class=\"line\"><span class=\"javascript\">                                    $(<span class=\"string\">\"#btnSend\"</span>).attr(<span class=\"string\">\"disabled\"</span>, <span class=\"string\">\"disabled\"</span>);</span></span><br><span class=\"line\"><span class=\"undefined\">                                &#125;;</span></span><br><span class=\"line\"><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\">                                <span class=\"comment\">//监听窗口关闭事件，当窗口关闭时，主动去关闭websocket连接，防止连接还没断开就关闭窗口，server端会抛异常。</span></span></span><br><span class=\"line\"><span class=\"javascript\">                                <span class=\"built_in\">window</span>.onbeforeunload = <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span></span><br><span class=\"line\"><span class=\"undefined\">                                    closeWebSocket();</span></span><br><span class=\"line\"><span class=\"undefined\">                                &#125;;</span></span><br><span class=\"line\"><span class=\"javascript\">                            &#125; <span class=\"keyword\">else</span> &#123;</span></span><br><span class=\"line\"><span class=\"javascript\">                                alert(<span class=\"string\">'Not support websocket'</span>);</span></span><br><span class=\"line\"><span class=\"undefined\">                            &#125;</span></span><br><span class=\"line\"><span class=\"undefined\">                        &#125;</span></span><br><span class=\"line\"><span class=\"javascript\">                        <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span></span><br><span class=\"line\"><span class=\"undefined\">                    &#125;</span></span><br><span class=\"line\"><span class=\"javascript\">                    <span class=\"built_in\">window</span>.onload = init();</span></span><br><span class=\"line\"><span class=\"undefined\">        </span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>\n<p>到此就可以使用 WebSocket 进行前后端的通信了,Good Luck.</p>\n","text":"在Java代码中使用Spring WebSocket首先 pom.xml<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>1","link":"","raw":null,"photos":[],"categories":[{"name":"java","slug":"java","count":21,"path":"api/categories/java.json"},{"name":"Spring","slug":"java/Spring","count":2,"path":"api/categories/java/Spring.json"},{"name":"websocket","slug":"java/Spring/websocket","count":1,"path":"api/categories/java/Spring/websocket.json"}],"tags":[{"name":"java","slug":"java","count":25,"path":"api/tags/java.json"},{"name":"spring-boot","slug":"spring-boot","count":3,"path":"api/tags/spring-boot.json"},{"name":"SpringWebSocket","slug":"SpringWebSocket","count":1,"path":"api/tags/SpringWebSocket.json"},{"name":"WebSocket","slug":"WebSocket","count":1,"path":"api/tags/WebSocket.json"}]},{"title":"在spring-starter-redis中实现一个RedisSerializer<T>","slug":"在spring-starter-redis中实现一个RedisSerializer-T","date":"2018-12-11T09:12:53.000Z","updated":"2018-12-11T09:12:53.090Z","comments":true,"path":"api/articles/在spring-starter-redis中实现一个RedisSerializer-T.json","excerpt":"","keywords":null,"cover":null,"content":"<h1 id=\"实现一个RedisSerializer用在spring-boot-starter-data-redis中\"><a href=\"#实现一个RedisSerializer用在spring-boot-starter-data-redis中\" class=\"headerlink\" title=\"实现一个RedisSerializer用在spring-boot-starter-data-redis中\"></a>实现一个RedisSerializer<t>用在spring-boot-starter-data-redis中</t></h1><h3 id=\"需求\"><a href=\"#需求\" class=\"headerlink\" title=\"需求:\"></a>需求:</h3><p>因为会使用到Spring-redis作为缓存框架缓存数据,不让程序每次查询都进到数据库中,因此正对不同的数据格式需要进行序列化和反序列化,于是就自己实现了一个简单的序列化类</p>\n<h3 id=\"首先-配置-Springboot-的-redis-配置\"><a href=\"#首先-配置-Springboot-的-redis-配置\" class=\"headerlink\" title=\"首先 配置 Springboot 的 redis 配置\"></a>首先 配置 Springboot 的 redis 配置</h3><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># REDIS (RedisProperties)</span></span><br><span class=\"line\"><span class=\"comment\"># Redis数据库索引（默认为0）</span></span><br><span class=\"line\">spring.redis.database=0  </span><br><span class=\"line\"><span class=\"comment\"># Redis服务器地址</span></span><br><span class=\"line\">spring.redis.host=192.168.0.11</span><br><span class=\"line\"><span class=\"comment\"># Redis服务器连接端口</span></span><br><span class=\"line\">spring.redis.port=6379  </span><br><span class=\"line\"><span class=\"comment\"># Redis服务器连接密码（默认为空）</span></span><br><span class=\"line\">spring.redis.password=ThisIsPass</span><br><span class=\"line\"><span class=\"comment\"># 连接池最大连接数（使用负值表示没有限制）</span></span><br><span class=\"line\">spring.redis.pool.max-active=-1  </span><br><span class=\"line\"><span class=\"comment\"># 连接池最大阻塞等待时间（使用负值表示没有限制）</span></span><br><span class=\"line\">spring.redis.pool.max-wait=-1  </span><br><span class=\"line\"><span class=\"comment\"># 连接池中的最大空闲连接</span></span><br><span class=\"line\">spring.redis.pool.max-idle=8  </span><br><span class=\"line\"><span class=\"comment\"># 连接池中的最小空闲连接</span></span><br><span class=\"line\">spring.redis.pool.min-idle=2  </span><br><span class=\"line\"><span class=\"comment\"># 连接超时时间（毫秒）</span></span><br><span class=\"line\">spring.redis.timeout=50</span><br></pre></td></tr></table></figure>\n<h3 id=\"接下来实现-序列化类-这里使用到了GSON\"><a href=\"#接下来实现-序列化类-这里使用到了GSON\" class=\"headerlink\" title=\"接下来实现 序列化类 (这里使用到了GSON):\"></a>接下来实现 序列化类 (这里使用到了GSON):</h3><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"JAVA\"><figure class=\"iseeu highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.data.redis.serializer.RedisSerializer;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.data.redis.serializer.SerializationException;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RedisValueSerializer</span>&lt;<span class=\"title\">T</span>&gt; <span class=\"keyword\">implements</span> <span class=\"title\">RedisSerializer</span>&lt;<span class=\"title\">T</span>&gt; </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">byte</span>[] EMPTY_ARRAY = <span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[<span class=\"number\">0</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">byte</span>[] serialize(T t) <span class=\"keyword\">throws</span> SerializationException &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (t == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> EMPTY_ARRAY;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        String tmp = String.format(<span class=\"string\">\"%s_%s\"</span>, t.getClass().getName(), JsonUtils.obj2Json(t));</span><br><span class=\"line\">        <span class=\"keyword\">return</span> tmp.getBytes(Encode.UTF8);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> T <span class=\"title\">deserialize</span><span class=\"params\">(<span class=\"keyword\">byte</span>[] bytes)</span> <span class=\"keyword\">throws</span> SerializationException </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (bytes == <span class=\"keyword\">null</span> || bytes.length &lt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            String tmp = <span class=\"keyword\">new</span> String(bytes, Encode.UTF8);</span><br><span class=\"line\">            String className = tmp.substring(<span class=\"number\">0</span>, tmp.indexOf(<span class=\"string\">\"_&#123;\"</span>));</span><br><span class=\"line\">            String json = tmp.substring(tmp.indexOf(<span class=\"string\">\"_&#123;\"</span>) + <span class=\"number\">1</span>);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> (T) JsonUtils.json2Obj(json, Class.forName(className));</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (ClassNotFoundException ex) &#123;</span><br><span class=\"line\">            LogUtils.error(TAG.DEF, <span class=\"keyword\">this</span>.getClass(), <span class=\"string\">\"deserialize\"</span>, ex);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div>\n<h3 id=\"然后RedisConfig\"><a href=\"#然后RedisConfig\" class=\"headerlink\" title=\"然后RedisConfig:\"></a>然后RedisConfig:</h3><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"JAVA\"><figure class=\"iseeu highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.cache.CacheManager;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.cache.annotation.CachingConfigurerSupport;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Bean;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Configuration;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.Primary;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.data.redis.cache.RedisCacheManager;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.data.redis.connection.RedisConnectionFactory;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.data.redis.core.StringRedisTemplate;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Primary</span></span><br><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RedisConfig</span> <span class=\"keyword\">extends</span> <span class=\"title\">CachingConfigurerSupport</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Primary</span></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> CacheManager <span class=\"title\">cacheManager</span><span class=\"params\">(RedisTemplate redisTemplate)</span> </span>&#123;</span><br><span class=\"line\">        RedisCacheManager rcm = <span class=\"keyword\">new</span> RedisCacheManager(redisTemplate);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> rcm;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Primary</span></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> StringRedisTemplate <span class=\"title\">redisTemplate</span><span class=\"params\">(RedisConnectionFactory factory)</span> </span>&#123;</span><br><span class=\"line\">        StringRedisTemplate template = <span class=\"keyword\">new</span> StringRedisTemplate(factory);</span><br><span class=\"line\">        template.setValueSerializer(<span class=\"keyword\">new</span> RedisValueSerializer&lt;Object&gt;());</span><br><span class=\"line\">        template.afterPropertiesSet();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> template;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div>\n<h3 id=\"然后就可以使用缓存注解了\"><a href=\"#然后就可以使用缓存注解了\" class=\"headerlink\" title=\"然后就可以使用缓存注解了:\"></a>然后就可以使用缓存注解了:</h3><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"JAVA\"><figure class=\"iseeu highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Cacheable</span>(key =<span class=\"string\">\"#p0\"</span>) </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@CachePut</span>(key = <span class=\"string\">\"#p0\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@CacheEvict</span>(key =<span class=\"string\">\"#p0\"</span>,allEntries=<span class=\"keyword\">true</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure></div>\n<h3 id=\"注解使用参考\"><a href=\"#注解使用参考\" class=\"headerlink\" title=\"注解使用参考:\"></a>注解使用参考:</h3><p><a href=\"http://blog.csdn.net/sanjay_f/article/details/47372967\" target=\"_blank\" rel=\"noopener\">http://blog.csdn.net/sanjay_f/article/details/47372967</a></p>\n","text":"实现一个RedisSerializer用在spring-boot-starter-data-redis中需求:因为会使用到Spring-redis作为缓存框架缓存数据,不让程序每次查询都进到数据库中,因此正对不同的数据格式需要进行序列化和反序列化,于是就自己实现了一个简单的序列化","link":"","raw":null,"photos":[],"categories":[{"name":"java","slug":"java","count":21,"path":"api/categories/java.json"},{"name":"redis","slug":"java/redis","count":1,"path":"api/categories/java/redis.json"},{"name":"RedisSerializer","slug":"java/redis/RedisSerializer","count":1,"path":"api/categories/java/redis/RedisSerializer.json"}],"tags":[{"name":"java","slug":"java","count":25,"path":"api/tags/java.json"},{"name":"redis","slug":"redis","count":3,"path":"api/tags/redis.json"},{"name":"spring-boot","slug":"spring-boot","count":3,"path":"api/tags/spring-boot.json"},{"name":"RedisSerializer","slug":"RedisSerializer","count":1,"path":"api/tags/RedisSerializer.json"}]},{"title":"Glassfish常用操作","slug":"Glassfish常用操作","date":"2018-12-11T09:09:37.000Z","updated":"2018-12-11T09:09:37.230Z","comments":true,"path":"api/articles/Glassfish常用操作.json","excerpt":"","keywords":null,"cover":null,"content":"<h1 id=\"Glassfish常用操作\"><a href=\"#Glassfish常用操作\" class=\"headerlink\" title=\"Glassfish常用操作\"></a>Glassfish常用操作</h1><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"CMD\"><figure class=\"iseeu highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">## 创建名为DomainName的域</span><br><span class=\"line\"></span><br><span class=\"line\">./asadmin create-domain [DomainName]</span><br><span class=\"line\"><span class=\"number\">1</span>.输入管理员账号</span><br><span class=\"line\"><span class=\"number\">2</span>.输入管理员密码</span><br><span class=\"line\"><span class=\"number\">3</span>.确认管理员密码</span><br><span class=\"line\"></span><br><span class=\"line\">## 接收外部网络的访问,此操作需要先启动域,再操作,然后在重启域</span><br><span class=\"line\">./asadmin --port <span class=\"number\">4848</span> enable-secure-admin</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">## 启动名为DomainName的域</span><br><span class=\"line\">./asadmin <span class=\"built_in\">start</span>-domain [DomainName]</span><br><span class=\"line\"></span><br><span class=\"line\">## 停止名为DomainName的域</span><br><span class=\"line\">./asadmin stop-domain [DomainName]</span><br><span class=\"line\"></span><br><span class=\"line\">## 重启名为DomainName的域</span><br><span class=\"line\">./asadmin restart-domain [DomainName]</span><br></pre></td></tr></table></figure></div>\n","text":"Glassfish常用操作1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>## 创建名为DomainName的域<br","link":"","raw":null,"photos":[],"categories":[{"name":"glassfish","slug":"glassfish","count":1,"path":"api/categories/glassfish.json"}],"tags":[{"name":"glassfish","slug":"glassfish","count":1,"path":"api/tags/glassfish.json"},{"name":"asadmin","slug":"asadmin","count":1,"path":"api/tags/asadmin.json"},{"name":"domain","slug":"domain","count":1,"path":"api/tags/domain.json"}]},{"title":"Java的Excel导出工具类","slug":"Java的Excel导出工具类","date":"2018-12-11T09:08:42.000Z","updated":"2018-12-11T09:08:42.223Z","comments":true,"path":"api/articles/Java的Excel导出工具类.json","excerpt":"","keywords":null,"cover":null,"content":"<h1 id=\"Java的Excel导出工具类\"><a href=\"#Java的Excel导出工具类\" class=\"headerlink\" title=\"Java的Excel导出工具类\"></a>Java的Excel导出工具类</h1><p>###首先在POM中引入需要的Jar<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"XML\"><figure class=\"iseeu highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.alibaba<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>fastjson<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>1.2.47<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.poi<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>poi<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.17<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.apache.poi<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>poi-ooxml<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>3.17<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></div></p>\n<h3 id=\"工具类\"><a href=\"#工具类\" class=\"headerlink\" title=\"工具类:\"></a>工具类:</h3><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"JAVA\"><figure class=\"iseeu highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> com.alibaba.fastjson.JSON;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.OutputStream;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.lang.reflect.Field;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Arrays;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Collection;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Date;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Iterator;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Map;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.function.Function;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.stream.Collectors;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.xssf.usermodel.XSSFCell;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.xssf.usermodel.XSSFRow;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.xssf.usermodel.XSSFSheet;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.apache.poi.xssf.usermodel.XSSFWorkbook;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Excel</span>&lt;<span class=\"title\">T</span>&gt; </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> XSSFWorkbook workBook = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> XSSFSheet sheet = <span class=\"keyword\">null</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Excel</span><span class=\"params\">(String sheetName, String... headers)</span> </span>&#123;</span><br><span class=\"line\">        workBook = <span class=\"keyword\">new</span> XSSFWorkbook();</span><br><span class=\"line\">        sheet = workBook.createSheet(sheetName);</span><br><span class=\"line\"></span><br><span class=\"line\">        XSSFRow titleRow = sheet.createRow((<span class=\"keyword\">short</span>) <span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> index = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (String header : headers) &#123;</span><br><span class=\"line\">            XSSFCell cell = titleRow.createCell((<span class=\"keyword\">short</span>) index);</span><br><span class=\"line\">            cell.setCellValue(header);</span><br><span class=\"line\">            index++;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Excel</span><span class=\"params\">(String sheetName)</span> </span>&#123;</span><br><span class=\"line\">        workBook = <span class=\"keyword\">new</span> XSSFWorkbook();</span><br><span class=\"line\">        sheet = workBook.createSheet(sheetName);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> Map&lt;String, Field&gt; <span class=\"title\">extract</span><span class=\"params\">(T obj)</span> </span>&#123;</span><br><span class=\"line\">        List&lt;Field&gt; declaredFields = Arrays.asList(obj.getClass().getDeclaredFields());</span><br><span class=\"line\">        <span class=\"keyword\">return</span> declaredFields.stream().collect(Collectors.toMap(Field::getName, Function.identity()));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">export</span><span class=\"params\">(OutputStream out)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            workBook.write(out);</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (IOException ex) &#123;</span><br><span class=\"line\">            ex.printStackTrace();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                out.flush();</span><br><span class=\"line\">                out.close();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (IOException ex) &#123;</span><br><span class=\"line\">                ex.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setDatas</span><span class=\"params\">(Collection&lt;T&gt; dataset, String... fieldNames)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (dataset == <span class=\"keyword\">null</span> || fieldNames == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        Iterator&lt;T&gt; it = dataset.iterator();</span><br><span class=\"line\">        <span class=\"keyword\">int</span> y = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (it.hasNext()) &#123;</span><br><span class=\"line\">            y++;</span><br><span class=\"line\">            XSSFRow row = sheet.createRow(y);</span><br><span class=\"line\">            T t = (T) it.next();</span><br><span class=\"line\">            Map&lt;String, Field&gt; fieldMap = <span class=\"keyword\">this</span>.extract(t);</span><br><span class=\"line\">            <span class=\"keyword\">int</span> x = -<span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (String fieldName : fieldNames) &#123;</span><br><span class=\"line\">                Field field = fieldMap.get(fieldName);</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (field == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                x++;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    field.setAccessible(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">                    String value;</span><br><span class=\"line\">                    Object obj = field.get(t);</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (obj <span class=\"keyword\">instanceof</span> Date) &#123;</span><br><span class=\"line\">                        value = DateUtil.format((Date) obj, <span class=\"string\">\"yyyy-MM-dd HH:mm:ss\"</span>);</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (obj <span class=\"keyword\">instanceof</span> String) &#123;</span><br><span class=\"line\">                        value = String.valueOf(obj);</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                        value = JSON.toJSONString(obj);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    XSSFCell cell = row.createCell((<span class=\"keyword\">short</span>) x);</span><br><span class=\"line\">                    cell.setCellValue(value);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (Exception ex) &#123;</span><br><span class=\"line\">                    ex.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div>\n<h3 id=\"在网页上导出\"><a href=\"#在网页上导出\" class=\"headerlink\" title=\"在网页上导出:\"></a>在网页上导出:</h3><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"JAVA\"><figure class=\"iseeu highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RequestMapping</span>(value = <span class=\"string\">\"/api/export\"</span>, method = RequestMethod.GET)</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">export</span><span class=\"params\">(HttpServletRequest request, HttpServletResponse response)</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">\t\tList&lt;TmpData&gt; tmps = findTempDate();</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tString name = DateUtil.current(<span class=\"string\">\"yyyyMMddHHmmsss\"</span>);</span><br><span class=\"line\">\t\tresponse.setContentType(<span class=\"string\">\"octets/stream\"</span>);</span><br><span class=\"line\">\t\tresponse.addHeader(<span class=\"string\">\"Content-Disposition\"</span>, <span class=\"string\">\"attachment;filename = \"</span> + name + <span class=\"string\">\".xlsx\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tExcel&lt;TmpData&gt; export = <span class=\"keyword\">new</span> Excel&lt;&gt;(<span class=\"string\">\"查询导出\"</span>, <span class=\"string\">\"账号\"</span>, <span class=\"string\">\"密码\"</span>, <span class=\"string\">\"IP\"</span>);</span><br><span class=\"line\">\t\texport.setDatas(tmps, <span class=\"string\">\"account\"</span>, <span class=\"string\">\"password\"</span>, <span class=\"string\">\"ip\"</span>);</span><br><span class=\"line\">\t\texport.export(response.getOutputStream());</span><br><span class=\"line\">\t&#125; <span class=\"keyword\">catch</span> (IOException ex) &#123;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div>\n<p>这样就可以了,至于设置样式之类的,各位自行百度吧…</p>\n","text":"Java的Excel导出工具类###首先在POM中引入需要的Jar<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>&lt;dependency&gt;<br>","link":"","raw":null,"photos":[],"categories":[{"name":"java","slug":"java","count":21,"path":"api/categories/java.json"},{"name":"excel","slug":"java/excel","count":1,"path":"api/categories/java/excel.json"},{"name":"poi","slug":"java/excel/poi","count":1,"path":"api/categories/java/excel/poi.json"}],"tags":[{"name":"java","slug":"java","count":25,"path":"api/tags/java.json"},{"name":"excel","slug":"excel","count":1,"path":"api/tags/excel.json"},{"name":"poi","slug":"poi","count":1,"path":"api/tags/poi.json"},{"name":"fastjson","slug":"fastjson","count":1,"path":"api/tags/fastjson.json"}]},{"title":"在Centos7中使用firewall添加端口","slug":"在Centos7中使用firewall添加端口","date":"2018-12-11T09:04:42.000Z","updated":"2018-12-11T09:04:42.120Z","comments":true,"path":"api/articles/在Centos7中使用firewall添加端口.json","excerpt":"","keywords":null,"cover":null,"content":"<h1 id=\"在Centos7中使用firewall添加端口\"><a href=\"#在Centos7中使用firewall添加端口\" class=\"headerlink\" title=\"在Centos7中使用firewall添加端口\"></a>在Centos7中使用firewall添加端口</h1><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">### 查看端口列表</span></span><br><span class=\"line\">firewall-cmd --zone=public --list-ports</span><br><span class=\"line\">firewall-cmd --zone=dmz --list-ports</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 添加80端口</span></span><br><span class=\"line\">firewall-cmd --zone=public --add-port=80/tcp --permanent</span><br><span class=\"line\">firewall-cmd --zone=public --add-port=80/udp --permanent</span><br><span class=\"line\">firewall-cmd --zone=dmz --add-port=80/tcp --permanent</span><br><span class=\"line\">firewall-cmd --zone=dmz --add-port=80/udp --permanent</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### 使添加的端口生效</span></span><br><span class=\"line\">firewall-cmd --reload</span><br></pre></td></tr></table></figure></div>\n","text":"在Centos7中使用firewall添加端口1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>### 查看端口列表<br>firewall-cmd --zone=public --list-ports<","link":"","raw":null,"photos":[],"categories":[{"name":"Centos","slug":"Centos","count":30,"path":"api/categories/Centos.json"},{"name":"firewall","slug":"Centos/firewall","count":2,"path":"api/categories/Centos/firewall.json"}],"tags":[{"name":"Centos","slug":"Centos","count":29,"path":"api/tags/Centos.json"},{"name":"firewall-cmd","slug":"firewall-cmd","count":3,"path":"api/tags/firewall-cmd.json"},{"name":"port","slug":"port","count":3,"path":"api/tags/port.json"}]},{"title":"对比Win10的文件","slug":"对比Win10的文件","date":"2018-12-11T09:03:50.000Z","updated":"2018-12-11T09:03:50.476Z","comments":true,"path":"api/articles/对比Win10的文件.json","excerpt":"","keywords":null,"cover":null,"content":"<h1 id=\"对比Win10的文件\"><a href=\"#对比Win10的文件\" class=\"headerlink\" title=\"对比Win10的文件\"></a>对比Win10的文件</h1><h3 id=\"在管理员命令提示符下键入以下命令：\"><a href=\"#在管理员命令提示符下键入以下命令：\" class=\"headerlink\" title=\"在管理员命令提示符下键入以下命令：\"></a>在管理员命令提示符下键入以下命令：</h3><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"CMD\"><figure class=\"iseeu highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">### 这条命令将扫描全部系统文件并和官方系统文件对比，扫描计算机中的不一致情况。</span><br><span class=\"line\"></span><br><span class=\"line\">Dism /Online /Cleanup-Image /ScanHealth</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">### 这条命令必须在前一条命令执行完以后，发现系统文件有损坏时使用</span><br><span class=\"line\"></span><br><span class=\"line\">Dism /Online /Cleanup-Image /CheckHealth</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">### 这条命令是把那些不同的系统文件还原成官方系统源文件</span><br><span class=\"line\">DISM /Online /Cleanup-image /RestoreHealth</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">###  完成后重启，再键入以下命令</span><br><span class=\"line\"></span><br><span class=\"line\">sfc /SCANNOW</span><br></pre></td></tr></table></figure></div>\n","text":"对比Win10的文件在管理员命令提示符下键入以下命令：1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>### 这条命令将扫描全部系统文件并和官","link":"","raw":null,"photos":[],"categories":[{"name":"windows","slug":"windows","count":9,"path":"api/categories/windows.json"},{"name":"cmd","slug":"windows/cmd","count":5,"path":"api/categories/windows/cmd.json"}],"tags":[{"name":"cmd","slug":"cmd","count":10,"path":"api/tags/cmd.json"},{"name":"windows","slug":"windows","count":9,"path":"api/tags/windows.json"},{"name":"dism","slug":"dism","count":1,"path":"api/tags/dism.json"}]},{"title":"Win8.1上安装.NET Framework3.5","slug":"Win8-1上安装-NET-Framework3-5","date":"2018-12-11T09:03:07.000Z","updated":"2018-12-11T09:03:07.199Z","comments":true,"path":"api/articles/Win8-1上安装-NET-Framework3-5.json","excerpt":"","keywords":null,"cover":null,"content":"<h1 id=\"Win8-1上安装-NET-Framework3-5\"><a href=\"#Win8-1上安装-NET-Framework3-5\" class=\"headerlink\" title=\"Win8.1上安装.NET Framework3.5\"></a>Win8.1上安装.NET Framework3.5</h1><p>1.首先找到你的系统安装文件 如:cn_windows_8.1_professional_vl_with_update_x64_dvd_4050293.iso</p>\n<p>2.解压出来的路径: E:\\cn_windows_8.1_professional_vl_with_update_x64_dvd_4050293</p>\n<p>3.找到 组件位置 : 解压出来的文件夹下  \\sources\\sxs</p>\n<p>4.打开CMD 运行<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"CMD\"><figure class=\"iseeu highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dism.exe /online /enable-feature /featurename:NetFX3 /Source:E:\\cn_windows_8.<span class=\"number\">1</span>_professional_vl_with_update_x64_dvd_4050293\\sources\\sxs</span><br></pre></td></tr></table></figure></div></p>\n<p>就可以看到安装的进度了</p>\n<p>++==注意需要修改路径为自己解压出来的路径==++</p>\n","text":"Win8.1上安装.NET Framework3.51.首先找到你的系统安装文件 如:cn_windows_8.1_professional_vl_with_update_x64_dvd_4050293.iso2.解压出来的路径: E:\\cn_windows_8.1_profes","link":"","raw":null,"photos":[],"categories":[{"name":"windows","slug":"windows","count":9,"path":"api/categories/windows.json"},{"name":"cmd","slug":"windows/cmd","count":5,"path":"api/categories/windows/cmd.json"},{"name":"netframwork","slug":"windows/cmd/netframwork","count":1,"path":"api/categories/windows/cmd/netframwork.json"}],"tags":[{"name":"cmd","slug":"cmd","count":10,"path":"api/tags/cmd.json"},{"name":"windows","slug":"windows","count":9,"path":"api/tags/windows.json"},{"name":"netframework3.5","slug":"netframework3-5","count":1,"path":"api/tags/netframework3-5.json"}]},{"title":"安装Win出现无法创建新的分区也找不到现有的分区解决方案","slug":"安装Win出现无法创建新的分区也找不到现有的分区解决方案","date":"2018-12-11T09:01:07.000Z","updated":"2018-12-11T09:01:07.783Z","comments":true,"path":"api/articles/安装Win出现无法创建新的分区也找不到现有的分区解决方案.json","excerpt":"","keywords":null,"cover":null,"content":"<h1 id=\"安装Win出现无法创建新的分区也找不到现有的分区解决方案\"><a href=\"#安装Win出现无法创建新的分区也找不到现有的分区解决方案\" class=\"headerlink\" title=\"安装Win出现无法创建新的分区也找不到现有的分区解决方案\"></a>安装Win出现无法创建新的分区也找不到现有的分区解决方案</h1><h2 id=\"安装Win出现无法创建新的分区也找不到现有的分区解决方案-1\"><a href=\"#安装Win出现无法创建新的分区也找不到现有的分区解决方案-1\" class=\"headerlink\" title=\"安装Win出现无法创建新的分区也找不到现有的分区解决方案\"></a>安装Win出现无法创建新的分区也找不到现有的分区解决方案</h2><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"CMD\"><figure class=\"iseeu highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">### 首先在安装界面按下 <span class=\"built_in\">Shift</span>+F10</span><br><span class=\"line\"></span><br><span class=\"line\">### 在出现的<span class=\"built_in\">CMD</span>界面输入:  diskpart  进入磁盘管理工具</span><br><span class=\"line\">diskpart</span><br><span class=\"line\"></span><br><span class=\"line\">### 可以输入 : list disk 查看磁盘列表</span><br><span class=\"line\">list disk</span><br><span class=\"line\"></span><br><span class=\"line\">### 选择你需要安装的磁盘序号(假设选择第一个) </span><br><span class=\"line\">select disk <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\">### 清除磁盘数据: </span><br><span class=\"line\">clean</span><br><span class=\"line\"></span><br><span class=\"line\">### 转换分区: </span><br><span class=\"line\"><span class=\"built_in\">convert</span> mbr</span><br><span class=\"line\"></span><br><span class=\"line\">### 查看磁盘上的分区列表:  </span><br><span class=\"line\">list partition</span><br><span class=\"line\"></span><br><span class=\"line\">### 创建用于安装系统的主分区(<span class=\"number\">100</span>G): </span><br><span class=\"line\">create partition primary size = <span class=\"number\">100000</span></span><br><span class=\"line\"></span><br><span class=\"line\">### 完成后再查看分区: </span><br><span class=\"line\">list partition</span><br><span class=\"line\"></span><br><span class=\"line\">### 退出磁盘管理工具:</span><br><span class=\"line\"><span class=\"keyword\">exit</span></span><br><span class=\"line\"></span><br><span class=\"line\">### 退出命令行: </span><br><span class=\"line\"><span class=\"keyword\">exit</span></span><br><span class=\"line\"></span><br><span class=\"line\">再继续安装吧</span><br></pre></td></tr></table></figure></div>\n<h2 id=\"转换为-GPT分区的操作-Win不支持的磁盘格式\"><a href=\"#转换为-GPT分区的操作-Win不支持的磁盘格式\" class=\"headerlink\" title=\"转换为 GPT分区的操作(Win不支持的磁盘格式)\"></a>转换为 GPT分区的操作(Win不支持的磁盘格式)</h2><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"CMD\"><figure class=\"iseeu highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">### 转换为 GPT分区的操作</span><br><span class=\"line\"></span><br><span class=\"line\">### 从转换分区开始: </span><br><span class=\"line\"><span class=\"built_in\">convert</span> gpt</span><br><span class=\"line\"></span><br><span class=\"line\">### 创建特有EFI分区(<span class=\"number\">500</span>M):  </span><br><span class=\"line\">create partition efi size = <span class=\"number\">500</span></span><br><span class=\"line\"></span><br><span class=\"line\">### 创建特有MSR分区(<span class=\"number\">500</span>M):  </span><br><span class=\"line\">create partition msr size = <span class=\"number\">500</span></span><br></pre></td></tr></table></figure></div>\n","text":"安装Win出现无法创建新的分区也找不到现有的分区解决方案安装Win出现无法创建新的分区也找不到现有的分区解决方案1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<","link":"","raw":null,"photos":[],"categories":[{"name":"windows","slug":"windows","count":9,"path":"api/categories/windows.json"},{"name":"cmd","slug":"windows/cmd","count":5,"path":"api/categories/windows/cmd.json"},{"name":"disk","slug":"windows/cmd/disk","count":1,"path":"api/categories/windows/cmd/disk.json"}],"tags":[{"name":"disk","slug":"disk","count":4,"path":"api/tags/disk.json"},{"name":"cmd","slug":"cmd","count":10,"path":"api/tags/cmd.json"},{"name":"windows","slug":"windows","count":9,"path":"api/tags/windows.json"},{"name":"mbr","slug":"mbr","count":1,"path":"api/tags/mbr.json"},{"name":"gpt","slug":"gpt","count":1,"path":"api/tags/gpt.json"},{"name":"partition","slug":"partition","count":1,"path":"api/tags/partition.json"}]}]}