{"title":"配置Mysql主从服务","slug":"配置Mysql主从服务","date":"2018-12-12T02:04:06.000Z","updated":"2018-12-12T02:04:06.094Z","comments":true,"path":"api/articles/配置Mysql主从服务.json","photos":[],"link":"","excerpt":"","covers":null,"content":"<h3 id=\"配置主数据库-my-cnf\"><a href=\"#配置主数据库-my-cnf\" class=\"headerlink\" title=\"配置主数据库  my.cnf\"></a>配置主数据库  my.cnf</h3><p>server-id=1<br>log-bin=master-bin<br>log-bin-index=master-bin.index</p>\n<h3 id=\"在主数据库上创建同步账号\"><a href=\"#在主数据库上创建同步账号\" class=\"headerlink\" title=\"在主数据库上创建同步账号\"></a>在主数据库上创建同步账号</h3><p>create user backup;<br>GRANT REPLICATION SLAVE ON <em>.</em> TO ‘backup‘@’192.168.%.%’ IDENTIFIED BY ‘mysql’;</p>\n<h3 id=\"配置从数据库-my-cnf\"><a href=\"#配置从数据库-my-cnf\" class=\"headerlink\" title=\"配置从数据库  my.cnf\"></a>配置从数据库  my.cnf</h3><p>server-id=2<br>relay-log-index=slave-relay-bin.index<br>relay-log=slave-relay-bin</p>\n<h3 id=\"重启mysql服务\"><a href=\"#重启mysql服务\" class=\"headerlink\" title=\"重启mysql服务\"></a>重启mysql服务</h3><p>service mysqld restart</p>\n<h3 id=\"连接Master服务\"><a href=\"#连接Master服务\" class=\"headerlink\" title=\"连接Master服务\"></a>连接Master服务</h3><p>change master to master_host=’192.168.91.128’,master_port=3306,master_user=’backup’,master_password=’mysql’,master_log_file=’master-bin.000001’,master_log_pos=0;</p>\n<h3 id=\"启动slave服务\"><a href=\"#启动slave服务\" class=\"headerlink\" title=\"启动slave服务\"></a>启动slave服务</h3><p>start slave;</p>\n<h3 id=\"查看Master服务状态\"><a href=\"#查看Master服务状态\" class=\"headerlink\" title=\"查看Master服务状态\"></a>查看Master服务状态</h3><p>SHOW MASTER STATUS;</p>\n<h3 id=\"查看Slave服务状态\"><a href=\"#查看Slave服务状态\" class=\"headerlink\" title=\"查看Slave服务状态\"></a>查看Slave服务状态</h3><p>SHOW slave STATUS \\G;</p>\n<h3 id=\"检查server-id是否一样-需要不一样\"><a href=\"#检查server-id是否一样-需要不一样\" class=\"headerlink\" title=\"检查server_id是否一样,需要不一样\"></a>检查server_id是否一样,需要不一样</h3><p>show variables like ‘server_id’;</p>\n<h3 id=\"常见错误\"><a href=\"#常见错误\" class=\"headerlink\" title=\"常见错误\"></a>常见错误</h3><p>错误: Fatal error: The slave I/O thread stops because master and slave have equal MySQL server UUIDs; these UUIDs must be different for replication to work.<br>解决方式: 检查data目录中的auto.cnf中的server-uuid=<strong><strong><strong><strong><em>**</em></strong></strong></strong></strong> 是否一样的,要改为不一样</p>\n","categories":[{"name":"mysql","slug":"mysql","count":8,"path":"api/categories/mysql.json"},{"name":"master-slave","slug":"mysql/master-slave","count":1,"path":"api/categories/mysql/master-slave.json"}],"tags":[{"name":"mysql","slug":"mysql","count":10,"path":"api/tags/mysql.json"},{"name":"主从","slug":"主从","count":1,"path":"api/tags/主从.json"},{"name":"master","slug":"master","count":1,"path":"api/tags/master.json"},{"name":"slave","slug":"slave","count":1,"path":"api/tags/slave.json"}]}