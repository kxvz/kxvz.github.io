{"title":"Centos7 重新分配数据盘","slug":"Centos7-重新分配数据盘","date":"2018-12-11T09:51:47.000Z","updated":"2018-12-11T09:51:47.289Z","comments":true,"path":"api/articles/Centos7-重新分配数据盘.json","photos":[],"link":"","excerpt":"","covers":null,"content":"<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">## 假设有一块 500G的空间分配给了/home 现在需要重新进行分配 /home 100G 和 /opt 400G</span></span><br><span class=\"line\"></span><br><span class=\"line\">==注意备份数据==</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 卸载/home, 如果无法卸载请先终止使用/home的进程</span></span><br><span class=\"line\">umount /home</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 删除/home所在的lv</span></span><br><span class=\"line\">lvremove /dev/mapper/cl-home</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 新创建一个容量为100G的/home lv</span></span><br><span class=\"line\">lvcreate -L 100G -n home cl</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 创建文件系统</span></span><br><span class=\"line\">mkfs.xfs /dev/cl/home</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 挂载此lv到/home目录</span></span><br><span class=\"line\">mount /dev/cl/home /home </span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 新创建一个容量为400G的/opt lv</span></span><br><span class=\"line\">lvcreate -L 400G -n opt cl</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 创建文件系统</span></span><br><span class=\"line\">mkfs.xfs /dev/cl/opt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 挂载此lv到/opt</span></span><br><span class=\"line\">mount /dev/cl/opt /opt </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 编辑系统磁盘</span></span><br><span class=\"line\">vi /ect/fstab</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 添加两行配置</span></span><br><span class=\"line\">/dev/mapper/cl-home     /home                   xfs     defaults        0 0</span><br><span class=\"line\">/dev/mapper/cl-opt      /opt                    xfs     defaults        0 0</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 验证配置是否正确</span></span><br><span class=\"line\">mount -a</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 重新进行一次 mount</span></span><br><span class=\"line\">mount -n -o remount,rw /</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 重启服务器</span></span><br><span class=\"line\">init 6</span><br></pre></td></tr></table></figure></div>\n","categories":[{"name":"Centos","slug":"Centos","count":30,"path":"api/categories/Centos.json"},{"name":"mount","slug":"Centos/mount","count":2,"path":"api/categories/Centos/mount.json"}],"tags":[{"name":"mount","slug":"mount","count":2,"path":"api/tags/mount.json"},{"name":"disk","slug":"disk","count":4,"path":"api/tags/disk.json"},{"name":"centos","slug":"centos","count":1,"path":"api/tags/centos.json"}]}