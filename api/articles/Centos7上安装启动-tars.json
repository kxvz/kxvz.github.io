{"title":"Centos7上安装启动 tars","slug":"Centos7上安装启动-tars","date":"2018-12-11T09:35:41.000Z","updated":"2018-12-11T09:36:27.916Z","comments":true,"path":"api/articles/Centos7上安装启动-tars.json","photos":[],"link":"","excerpt":"","covers":null,"content":"<h1 id=\"Centos7上安装启动-tars\"><a href=\"#Centos7上安装启动-tars\" class=\"headerlink\" title=\"Centos7上安装启动 tars\"></a>Centos7上安装启动 tars</h1><p>先在Centos的虚拟机上操作:</p>\n<p>首先安装 JDK 和 Mysql</p>\n<p>可以参照之前的文章: <a href=\"https://my.oschina.net/Kxvz/blog/420244\" target=\"_blank\" rel=\"noopener\">https://my.oschina.net/Kxvz/blog/420244</a></p>\n<p>SQL脚本地址: <a href=\"https://github.com/Tencent/Tars/tree/master/cpp/framework/sql\" target=\"_blank\" rel=\"noopener\">https://github.com/Tencent/Tars/tree/master/cpp/framework/sql</a></p>\n<p>安装好了之后进入数据库建库:</p>\n<div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"CMD\"><figure class=\"iseeu highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">## 这里我的数据库帐号密码是: root <span class=\"number\">123456</span></span><br><span class=\"line\">## mysql -u root -p123456</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">create database db_tars;</span><br><span class=\"line\">create database tars_stat;</span><br><span class=\"line\">create database tars_property;</span><br></pre></td></tr></table></figure></div>\n<p>建好库之后就导入db_tars.sql到db_tars库中 (可以参照:<a href=\"https://my.oschina.net/Kxvz/blog/417358\" target=\"_blank\" rel=\"noopener\">https://my.oschina.net/Kxvz/blog/417358</a>)</p>\n<p>数据库方面弄完之后可以开始安装 resin<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"BASH\"><figure class=\"iseeu highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">## 下载</span></span><br><span class=\"line\">wget http://www.caucho.com/download/resin-4.0.49.tar.gz</span><br><span class=\"line\"><span class=\"comment\">## 解压出来</span></span><br><span class=\"line\">tar zxvf resin-4.0.49.tar.gz</span><br></pre></td></tr></table></figure></div></p>\n<p>解压好 resin 后就可以去打包tars了.</p>\n<p>在开发机上操作:</p>\n<p>首先进入 Tars\\web 目录</p>\n<p>修改:src\\main\\resources 下的 app.config.properties 和 tars.conf</p>\n<p>app.config.properties<br><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tarsweb.datasource.tars.addr=127.0.0.1:3306</span><br><span class=\"line\">tarsweb.datasource.tars.user=root</span><br><span class=\"line\">tarsweb.datasource.tars.pswd=123456</span><br><span class=\"line\"></span><br><span class=\"line\">upload.tgz.path=\\opt\\app\\</span><br></pre></td></tr></table></figure></p>\n<p>tars.conf<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"XML\"><figure class=\"iseeu highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">tars</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">application</span>&gt;</span></span><br><span class=\"line\">\t\t#proxy需要的配置</span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">client</span>&gt;</span></span><br><span class=\"line\">\t\t\t#地址</span><br><span class=\"line\">\t\t\tlocator = tars.tarsregistry.QueryObj@tcp -h 127.0.0.1 -p 17890</span><br><span class=\"line\">\t\t\tsync-invoke-timeout = 20000</span><br><span class=\"line\">\t\t\t#最大超时时间(毫秒)</span><br><span class=\"line\">\t\t\tmax-invoke-timeout = 60000</span><br><span class=\"line\">\t\t\t#刷新端口时间间隔(毫秒)</span><br><span class=\"line\">\t\t\trefresh-endpoint-interval = 300000</span><br><span class=\"line\">\t\t\t#模块间调用[可选]</span><br><span class=\"line\">\t\t\tstat = tars.tarsstat.StatObj</span><br><span class=\"line\">\t\t\t#网络异步回调线程个数</span><br><span class=\"line\">\t\t\tasyncthread = 3</span><br><span class=\"line\">\t\t\tmodulename = tars.system</span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;/<span class=\"name\">client</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;/<span class=\"name\">application</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">tars</span>&gt;</span></span><br></pre></td></tr></table></figure></div></p>\n<p>完了之后用maven打包:  在Tars\\web目录下使用 cmd 输入: mvn clean install</p>\n<p>打包好了以后可以在Tars\\web\\target 下得到一个 tars.war</p>\n<p>然后把 tars.war 上传到 Centos的虚拟机上 并复制到 resin-4.0.49\\webapps 目录下</p>\n<p>然后进入 resin-4.0.49\\conf 目录中 修改  resin.xml 文件</p>\n<p>把:<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"XML\"><figure class=\"iseeu highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">host</span> <span class=\"attr\">id</span>=<span class=\"string\">\"\"</span> <span class=\"attr\">root-directory</span>=<span class=\"string\">\".\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">web-app</span> <span class=\"attr\">id</span>=<span class=\"string\">\"/\"</span> <span class=\"attr\">root-directory</span>=<span class=\"string\">\"webapps/ROOT\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">host</span>&gt;</span></span><br></pre></td></tr></table></figure></div></p>\n<p>改为:<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"XML\"><figure class=\"iseeu highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">host</span> <span class=\"attr\">id</span>=<span class=\"string\">\"\"</span> <span class=\"attr\">root-directory</span>=<span class=\"string\">\".\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">web-app</span> <span class=\"attr\">id</span>=<span class=\"string\">\"/\"</span> <span class=\"attr\">document-directory</span>=<span class=\"string\">\"webapps/tars\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">host</span>&gt;</span></span><br></pre></td></tr></table></figure></div></p>\n<p>完成后进进入 resin-4.0.49\\bin 目录中:</p>\n<p>启动服务:<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"CMD\"><figure class=\"iseeu highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./resin.sh <span class=\"built_in\">start</span></span><br></pre></td></tr></table></figure></div></p>\n<p>然后访问: http://{YourServerIP}:8080</p>\n<p>如果访问不了可能是你的Centos端口被关了 可以自己打开端口或者关闭防火墙</p>\n<p>添加端口可以参考 :<a href=\"https://my.oschina.net/Kxvz/blog/900648\" target=\"_blank\" rel=\"noopener\">https://my.oschina.net/Kxvz/blog/900648</a></p>\n<p>关闭防火墙:<br><div class=\"highlight-wrap\"autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"off\" spellcheck=\"false\" contenteditable=\"true\"data-rel=\"CMD\"><figure class=\"iseeu highlight cmd\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl stop firewalld</span><br></pre></td></tr></table></figure></div></p>\n<p>如此应该可以访问了::</p>\n<p>![image][<a href=\"https://static.oschina.net/uploads/space/2017/0811/171253_vLMk_2370543.png]\" target=\"_blank\" rel=\"noopener\">https://static.oschina.net/uploads/space/2017/0811/171253_vLMk_2370543.png]</a></p>\n","categories":[{"name":"Centos","slug":"Centos","count":30,"path":"api/categories/Centos.json"},{"name":"tars","slug":"Centos/tars","count":1,"path":"api/categories/Centos/tars.json"}],"tags":[{"name":"Centos","slug":"Centos","count":29,"path":"api/tags/Centos.json"},{"name":"tars","slug":"tars","count":1,"path":"api/tags/tars.json"}]}